<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Open Screen Protocol</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in Â§N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .assertion  for assertions                    (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/******************************************************************************/
/*                                   Body                                     */
/******************************************************************************/

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;               /* limit line length to 50em for readability   */
		margin: 0 auto;                /* center text within page                     */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag     */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		/* Colors */
		color: black;
		background: white top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		color: white;
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		border-color: #c00;
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 2;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
			color: black;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			background: white;
			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;
			background: white;
		}
		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		#toc-nav > a:hover,
		#toc-nav > a:focus {
			background: #f8f8f8;
		}
		#toc-nav > a:not(:hover):not(:focus) {
			color: #707070;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}

		#toc-toggle-inline {
			vertical-align: 0.05em;
			font-size: 80%;
			color: gray;
			color: hsla(203,20%,40%,.7);
			border-style: none;
			background: transparent;
			position: relative;
		}
		#toc-toggle-inline:hover:not(:active),
		#toc-toggle-inline:focus:not(:active) {
			text-shadow: 1px 1px silver;
			top: -1px;
			left: -1px;
		}

		#toc-nav :active {
			color: #C00;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;    /* Inherit the font family. */
		line-height: 1.2;        /* Keep wrapped headings compact */
		hyphens: manual;         /* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		background: transparent;
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	 border-left: 0.5em solid #DEF;
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	  padding: .5em;
	  border: thin solid #ddd; border-radius: .5em;
	  margin: .5em calc(-0.5em - 1px);
	}
	[data-algorithm]:not(.heading) > :first-child {
	  margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	  margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: medium;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		page-break-inside: avoid;
		hyphens: none;
		text-transform: none;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

  /* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		text-decoration: none;
		border-bottom: 1px solid #707070;
		/* Need a bit of extending for it to look okay */
		padding: 0 1px 0;
		margin: 0 -1px 0;
	}
	a:visited {
		border-bottom-color: #BBB;
	}

	/* Use distinguishing colors when user is interacting with the link */
	a[href]:focus,
	a[href]:hover {
		background: #f8f8f8;
		background: rgba(75%, 75%, 75%, .25);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	a[href]:active {
		color: #C00;
		border-color: #C00;
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	/* For autogen numbers, add
	   .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,    .sidefigure img,    figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	.issue,
	.note,
	.example,
	.advisement,
	.assertion,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		text-transform: uppercase;
		color: #AE1E1E;
		padding-right: 1em;
		text-transform: uppercase;
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	   or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		text-transform: uppercase;
		color: #827017;
		min-width: 7.5em;
		display: block;
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	   or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary::before,
	details.note > summary > .marker {
		text-transform: uppercase;
		display: block;
		color: hsl(120, 70%, 30%);
	}
	/* Add .note::before { content: "Note"; } for autogen label,
	   or use class="marker" to mark up the label in source. */

	details.note > summary {
		display: block;
		color: hsl(120, 70%, 30%);
	}
	details.note[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		background: #EEE;
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement > .marker {
		color: #B35F00;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		padding: .75em 1em;
		border: thick red;
		border-style: solid;
		border-radius: 1em;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def           td.footnote {
		padding-top: 0.6em;
	}
	table.def           td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
		 Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding-top: 0.1rem;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Reverse color scheme */
		color: black;
		border-color: #3980B5;
		border-bottom-width: 3px !important;
		margin-bottom: 0px !important;
	}
	.toc a:visited {
		border-color: #054572;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
		line-height: 1.1rem; /* consistent spacing */
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li             { font-weight: bold;   }
	.toc > li li          { font-weight: normal; }
	.toc > li li li       { font-size:   95%;    }
	.toc > li li li li    { font-size:   90%;    }
	.toc > li li li li .secno { font-size: 85%; }
	.toc > li li li li li { font-size:   85%;    }
	.toc > li li li li li .secno { font-size: 100%; }

	/* @supports not (display:grid) { */
		.toc > li             { margin: 1.5rem 0;    }
		.toc > li li          { margin: 0.3rem 0;    }
		.toc > li li li       { margin-left: 2rem;   }

		/* Section numbers in a column of their own */
		.toc .secno {
			float: left;
			width: 4rem;
			white-space: nowrap;
		}

		.toc li {
			clear: both;
		}

		:not(li) > .toc              { margin-left:  5rem; }
		.toc .secno                  { margin-left: -5rem; }
		.toc > li li li .secno       { margin-left: -7rem; }
		.toc > li li li li .secno    { margin-left: -9rem; }
		.toc > li li li li li .secno { margin-left: -11rem; }

		/* Tighten up indentation in narrow ToCs */
		@media (max-width: 30em) {
			:not(li) > .toc              { margin-left:  4rem; }
			.toc .secno                  { margin-left: -4rem; }
			.toc > li li li              { margin-left:  1rem; }
			.toc > li li li .secno       { margin-left: -5rem; }
			.toc > li li li li .secno    { margin-left: -6rem; }
			.toc > li li li li li .secno { margin-left: -7rem; }
		}
	/* } */

	@supports (display:grid) and (display:contents) {
		/* Use #toc over .toc to override non-@supports rules. */
		#toc {
			display: grid;
			align-content: start;
			grid-template-columns: auto 1fr;
			grid-column-gap: 1rem;
			column-gap: 1rem;
			grid-row-gap: .6rem;
			row-gap: .6rem;
		}
		#toc h2 {
			grid-column: 1 / -1;
			margin-bottom: 0;
		}
		#toc ol,
		#toc li,
		#toc a {
			display: contents;
			/* Switch <a> to subgrid when supported */
		}
		#toc span {
			margin: 0;
		}
		#toc > .toc > li > a > span {
			/* The spans of the top-level list,
			   comprising the first items of each top-level section. */
			margin-top: 1.1rem;
		}
		#toc#toc .secno { /* Ugh, need more specificity to override base.css */
			grid-column: 1;
			width: auto;
			margin-left: 0;
		}
		#toc .content {
			grid-column: 2;
			width: auto;
			margin-right: 1rem;
		}
		#toc .content:hover {
			background: rgba(75%, 75%, 75%, .25);
			border-bottom: 3px solid #054572;
			margin-bottom: -3px;
		}
		#toc li li li .content {
			margin-left: 1rem;
		}
		#toc li li li li .content {
			margin-left: 2rem;
		}
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index       { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li    { margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em }
	ul.index dl    { margin-top: 0; }
	ul.index dt    { margin: .2em 0 .2em 20px;}
	ul.index dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		background: #f7f8f9;
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

/******************************************************************************/
/*                                    Legacy                                  */
/******************************************************************************/

	/* This rule is inherited from past style sheets. No idea what it's for. */
	.hide { display: none }



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-left: calc(13px + 26.5rem - 50vw);
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-left: calc(40em - 50vw) !important;
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-left: 0 !important;
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			 * http://lea.verou.me/2012/04/background-attachment-local/
			 *
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
			            top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
			            top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
  <meta content="Bikeshed version 220086d88511a9c99d7a1f9b5447db7e7b99e053" name="generator">
  <link href="https://webscreens.github.io/openscreenprotocol/" rel="canonical">
  <meta content="db6056d9460cfd0e00d68d315ce6b720964522ff" name="document-revision">
<style>
.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #999988; font-style: italic } /* Comment */
.highlight .err { color: #a61717; background-color: #e3d2d2 } /* Error */
.highlight .k { color: #000000; font-weight: bold } /* Keyword */
.highlight .o { color: #000000; font-weight: bold } /* Operator */
.highlight .cm { color: #999988; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #999999; font-weight: bold; font-style: italic } /* Comment.Preproc */
.highlight .c1 { color: #999988; font-style: italic } /* Comment.Single */
.highlight .cs { color: #999999; font-weight: bold; font-style: italic } /* Comment.Special */
.highlight .gd { color: #000000; background-color: #ffdddd } /* Generic.Deleted */
.highlight .ge { color: #000000; font-style: italic } /* Generic.Emph */
.highlight .gr { color: #aa0000 } /* Generic.Error */
.highlight .gh { color: #999999 } /* Generic.Heading */
.highlight .gi { color: #000000; background-color: #ddffdd } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #555555 } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #aaaaaa } /* Generic.Subheading */
.highlight .gt { color: #aa0000 } /* Generic.Traceback */
.highlight .kc { color: #000000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #000000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #000000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #000000; font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: #000000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #445588; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #009999 } /* Literal.Number */
.highlight .s { color: #d01040 } /* Literal.String */
.highlight .na { color: #008080 } /* Name.Attribute */
.highlight .nb { color: #0086B3 } /* Name.Builtin */
.highlight .nc { color: #445588; font-weight: bold } /* Name.Class */
.highlight .no { color: #008080 } /* Name.Constant */
.highlight .nd { color: #3c5d5d; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #800080 } /* Name.Entity */
.highlight .ne { color: #990000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #990000; font-weight: bold } /* Name.Function */
.highlight .nl { color: #990000; font-weight: bold } /* Name.Label */
.highlight .nn { color: #555555 } /* Name.Namespace */
.highlight .nt { color: #000080 } /* Name.Tag */
.highlight .nv { color: #008080 } /* Name.Variable */
.highlight .ow { color: #000000; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #009999 } /* Literal.Number.Float */
.highlight .mh { color: #009999 } /* Literal.Number.Hex */
.highlight .mi { color: #009999 } /* Literal.Number.Integer */
.highlight .mo { color: #009999 } /* Literal.Number.Oct */
.highlight .sb { color: #d01040 } /* Literal.String.Backtick */
.highlight .sc { color: #d01040 } /* Literal.String.Char */
.highlight .sd { color: #d01040 } /* Literal.String.Doc */
.highlight .s2 { color: #d01040 } /* Literal.String.Double */
.highlight .se { color: #d01040 } /* Literal.String.Escape */
.highlight .sh { color: #d01040 } /* Literal.String.Heredoc */
.highlight .si { color: #d01040 } /* Literal.String.Interpol */
.highlight .sx { color: #d01040 } /* Literal.String.Other */
.highlight .sr { color: #009926 } /* Literal.String.Regex */
.highlight .s1 { color: #d01040 } /* Literal.String.Single */
.highlight .ss { color: #990073 } /* Literal.String.Symbol */
.highlight .bp { color: #999999 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #008080 } /* Name.Variable.Class */
.highlight .vg { color: #008080 } /* Name.Variable.Global */
.highlight .vi { color: #008080 } /* Name.Variable.Instance */
.highlight .il { color: #009999 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-dfn-panel */

.dfn-panel {
    position: absolute;
    z-index: 35;
    height: auto;
    width: -webkit-fit-content;
    width: fit-content;
    max-width: 300px;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: #DDDDDD;
    color: black;
    border: outset 0.2em;
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: black; }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-selflinks */

.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: gray;
    color: white;
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: black;
}

a.self-link::before            { content: "Â¶"; }
.heading > a.self-link::before { content: "Â§"; }
dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: #005a9c;
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "â";
}
.css::after, .property::after, .descriptor::after {
    content: "â";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "â";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "â";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1 class="p-name no-ref" id="title">Open Screen Protocol</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Editorâs Draft, <time class="dt-updated" datetime="2019-08-08">8 August 2019</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://webscreens.github.io/openscreenprotocol/">https://webscreens.github.io/openscreenprotocol/</a>
     <dt>Feedback:
     <dd><span><a href="mailto:public-webscreens@w3c.org?subject=%5Bopenscreenprotocol%5D%20YOUR%20TOPIC%20HERE">public-webscreens@w3c.org</a> with subject line â<kbd>[openscreenprotocol] <i data-lt>â¦ message topic â¦</i></kbd>â (<a href="https://lists.w3.org/Archives/Public/public-webscreens/" rel="discussion">archives</a>)</span>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/webscreens/openscreenprotocol/issues/">GitHub</a>
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard" data-editor-id="68454"><a class="p-name fn u-url url" href="https://github.com/mfoltzgoogle">Mark Foltz</a> (<span class="p-org org">Google</span>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"> <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright"> Copyright</a> Â© 2019 the Contributors to the Open Screen Protocol Specification,
  published by the <a href="https://www.w3.org/community/webscreens/"> Second Screen Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/"> W3C Community Contributor License Agreement (CLA)</a>.  A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>The Open Screen Protocol is a suite of network protocols that allow

          user agents to implement the <a data-link-type="biblio" href="#biblio-presentation-api">Presentation API</a> and
          the <a data-link-type="biblio" href="#biblio-remote-playback">Remote Playback API</a> in an interoperable
          fashion.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#introduction"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#terminology"><span class="secno">1.1</span> <span class="content">Terminology</span></a>
     </ol>
    <li>
     <a href="#requirements"><span class="secno">2</span> <span class="content">Requirements</span></a>
     <ol class="toc">
      <li><a href="#requirements-presentation-api"><span class="secno">2.1</span> <span class="content">Presentation API Requirements</span></a>
      <li><a href="#requirements-remote-playback"><span class="secno">2.2</span> <span class="content">Remote Playback API Requirements</span></a>
      <li><a href="#requirements-non-functional"><span class="secno">2.3</span> <span class="content">Non-Functional Requirements</span></a>
     </ol>
    <li><a href="#discovery"><span class="secno">3</span> <span class="content">Discovery with mDNS</span></a>
    <li><a href="#transport"><span class="secno">4</span> <span class="content">Transport and metadata discovery with QUIC</span></a>
    <li><a href="#messages"><span class="secno">5</span> <span class="content">Messages delivery using CBOR and QUIC streams</span></a>
    <li><a href="#authentication"><span class="secno">6</span> <span class="content">Authentication</span></a>
    <li>
     <a href="#control-protocols"><span class="secno">7</span> <span class="content">Control Protocols</span></a>
     <ol class="toc">
      <li><a href="#presentation-protocol"><span class="secno">7.1</span> <span class="content">Presentation Protocol</span></a>
      <li><a href="#presentation-api"><span class="secno">7.2</span> <span class="content">Presentation API</span></a>
      <li><a href="#remote-playback-protocol"><span class="secno">7.3</span> <span class="content">Remote Playback Protocol</span></a>
      <li><a href="#remote-playback-state-and-controls"><span class="secno">7.4</span> <span class="content">Remote Playback State and Controls</span></a>
      <li><a href="#remote-playback-api"><span class="secno">7.5</span> <span class="content">Remote Playback API</span></a>
     </ol>
    <li>
     <a href="#streaming-protocol"><span class="secno">8</span> <span class="content">Streaming Protocol</span></a>
     <ol class="toc">
      <li><a href="#streaming-capabilities"><span class="secno">8.1</span> <span class="content">Capabilities</span></a>
      <li><a href="#streaming-sessions"><span class="secno">8.2</span> <span class="content">Sessions</span></a>
      <li><a href="#streaming-audio"><span class="secno">8.3</span> <span class="content">Audio</span></a>
      <li><a href="#streaming-video"><span class="secno">8.4</span> <span class="content">Video</span></a>
      <li><a href="#media-streaming-data"><span class="secno">8.5</span> <span class="content">Data</span></a>
      <li><a href="#streaming-feedback"><span class="secno">8.6</span> <span class="content">Feedback</span></a>
      <li><a href="#streaming-stats"><span class="secno">8.7</span> <span class="content">Stats</span></a>
     </ol>
    <li><a href="#requests-responses--watches"><span class="secno">9</span> <span class="content">Requests, Responses, and Watches</span></a>
    <li>
     <a href="#security-privacy"><span class="secno">10</span> <span class="content">Security and Privacy</span></a>
     <ol class="toc">
      <li>
       <a href="#threat-models"><span class="secno">10.1</span> <span class="content">Threat Models</span></a>
       <ol class="toc">
        <li><a href="#passive-network-attackers"><span class="secno">10.1.1</span> <span class="content">Passive Network Attackers</span></a>
        <li><a href="#active-network-attackers"><span class="secno">10.1.2</span> <span class="content">Active Network Attackers</span></a>
        <li><a href="#denial-of-service"><span class="secno">10.1.3</span> <span class="content">Denial of Service</span></a>
        <li><a href="#same-origin-policy-violations"><span class="secno">10.1.4</span> <span class="content">Same-Origin Policy Violations</span></a>
       </ol>
      <li>
       <a href="#security-privacy-questions"><span class="secno">10.2</span> <span class="content">Open Screen Protocol Security and Privacy Considerations</span></a>
       <ol class="toc">
        <li><a href="#personally-identifiable-information"><span class="secno">10.2.1</span> <span class="content">Personally Identifiable Information &amp; High-Value Data</span></a>
        <li><a href="#cross-origin-state"><span class="secno">10.2.2</span> <span class="content">Cross Origin State Considerations</span></a>
        <li><a href="#origin-access-devices"><span class="secno">10.2.3</span> <span class="content">Origin Access to Other Devices</span></a>
        <li><a href="#incognito-mode"><span class="secno">10.2.4</span> <span class="content">Incognito Mode</span></a>
        <li><a href="#persistent-state"><span class="secno">10.2.5</span> <span class="content">Persistent State</span></a>
        <li><a href="#other-considerations"><span class="secno">10.2.6</span> <span class="content">Other Considerations</span></a>
       </ol>
      <li><a href="#presentation-api-considerations"><span class="secno">10.3</span> <span class="content">Presentation API Considerations</span></a>
      <li><a href="#remote-playback-considerations"><span class="secno">10.4</span> <span class="content">Remote Playback API Considerations</span></a>
      <li>
       <a href="#security-mitigations"><span class="secno">10.5</span> <span class="content">Mitigation Strategies</span></a>
       <ol class="toc">
        <li><a href="#local-passive-mitigations"><span class="secno">10.5.1</span> <span class="content">Local passive network attackers</span></a>
        <li><a href="#local-active-mitigations"><span class="secno">10.5.2</span> <span class="content">Local active network attackers</span></a>
        <li><a href="#remote-active-mitigations"><span class="secno">10.5.3</span> <span class="content">Remote active network attackers</span></a>
        <li><a href="#denial-of-service-mitigations"><span class="secno">10.5.4</span> <span class="content">Denial of service</span></a>
        <li><a href="#malicious-input-mitigations"><span class="secno">10.5.5</span> <span class="content">Malicious input</span></a>
       </ol>
     </ol>
    <li><a href="#appendix-a"><span class="secno"></span> <span class="content">Appendix A: Messages</span></a>
    <li><a href="#conformance"><span class="secno"></span> <span class="content"> Conformance</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <p class="issue" id="issue-b711fac3"><a class="self-link" href="#issue-b711fac3"></a> Add short names to Presentation API spec, so that BS autolinking works as designed.</p>
   <p class="issue" id="issue-a8c8d59b"><a class="self-link" href="#issue-a8c8d59b"></a> Can autolinks to HTML51 be automatically generated?</p>
   <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
   <p>This specification was published by the <a href="https://www.w3.org/community/webscreens/">Second Screen Community
Group</a>. It is not a W3C Standard nor
is it on the W3C Standards Track. It should not be viewed as a stable
specification, and may change in substantial ways at any time. A future version
of this document will be published as a Community Group Report.</p>
   <p>Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement
(CLA)</a> there is a limited
opt-out and other conditions apply.</p>
   <p>Learn more about <a href="http://www.w3.org/community/">W3C Community and Business
Groups</a>.</p>
   <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction"></a></h2>
   <p>The Open Screen Protocol connects browsers to devices capable of rendering Web
content for a shared audience.  Typically, these are devices like
Internet-connected TVs, HDMI dongles, or "smart" speakers.</p>
   <p>The protocol is a suite of subsidiary network protocols that enable two user
agents to implement the <a data-link-type="biblio" href="#biblio-presentation-api">Presentation API</a> and <a data-link-type="biblio" href="#biblio-remote-playback">Remote Playback API</a> in an interoperable fashion.  This means
that a user can expect these APIs work as intended when connecting two devices
from independent implementations of the Open Screen Protocol.</p>
   <p>The Open Screen Protocol is a specific implementation of these two APIs, meaning
that it does not handle all possible ways that browsers and presentation
displays could support these APIs.  The Open Screen Protocol specifically
supports browsers and displays that are connected via the same local area
network, and that initiate presentation or remote playback by sending a URL
from the browser to the target display.</p>
   <p>The Open Screen Protocol is intended to be extensible, so that additional
capabilities can be added over time.  This may include new implementations of
existing APIs, or new APIs.</p>
   <h3 class="heading settled" data-level="1.1" id="terminology"><span class="secno">1.1. </span><span class="content">Terminology</span><a class="self-link" href="#terminology"></a></h3>
   <p>We use the term "agent" to mean any implementation of this protocol
(browser, device, or otherwise), acting as a controller or a receiver.</p>
   <p>We borrow terminology from the <a data-link-type="biblio" href="#biblio-presentation-api">Presentation API</a>. We call
the agent that is used to discover and initiate presentation of Web content on
another device the <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-controller" id="ref-for-dfn-controller">controller</a> (or <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-controlling-user-agent" id="ref-for-dfn-controlling-user-agent">controlling user agent</a> when it is a
browser).  We call the agent on the device rendering the Web content the <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-receiver" id="ref-for-dfn-receiver">receiver</a> or <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-presentation-display" id="ref-for-dfn-presentation-display">presentation display</a> (or <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-receiving-user-agent" id="ref-for-dfn-receiving-user-agent">receiving user agent</a> when it is
a browser). <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-presentation-display-availability" id="ref-for-dfn-presentation-display-availability">presentation display availability</a> refers to whether or not a <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-receiver" id="ref-for-dfn-receiverâ ">receiver</a> is compatible with a <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-presentation-request-url" id="ref-for-dfn-presentation-request-url">presentation request URL</a>.  However, in the <a data-link-type="biblio" href="#biblio-presentation-api">Presentation API</a>, a "controller" refers to as a specific
browsing context within the browser, whereas here the "controller" refers to the
browser itself, although it may be acting on behalf of a browsing context.</p>
   <p>We borrow terminology from the <a data-link-type="biblio" href="#biblio-remote-playback">Remote Playback API</a>.  The
agent responsible for rendering media of a remote playback is called the <a data-link-type="dfn" href="https://w3c.github.io/remote-playback/#dfn-remote-playback-devices" id="ref-for-dfn-remote-playback-devices">remote playback device</a>. In this document, we also refer to it as the <em>receiver</em> because it is shorter and keeps terminology consistent between
presentations and remote playbacks. Similarly, we use the term "controller"
(referred to as the "user agent" in the <a data-link-type="biblio" href="#biblio-remote-playback">Remote Playback API</a>)
to refer to the agent that starts, terminates, and controls the remote playback.</p>
   <p>For media streaming, we refer to the agent sending media as the media <em>sender</em> and the agent receiving the media as the media <em>receiver</em>.
Note that a media <em>receiver</em> may or may not be a <em>receiver</em> or <em>controller</em> as defined by the Presentation API or Remote Playback
API.  Also note that an agent may be both a <em>sender</em> and <em>receiver</em>.</p>
   <p>For additional terms and idioms specific to the <a data-link-type="biblio" href="#biblio-presentation-api">Presentation
API</a> or <a data-link-type="biblio" href="#biblio-remote-playback">Remote Playback API</a>, please consult the respective
specifications.</p>
   <p class="issue" id="issue-8ce75287"><a class="self-link" href="#issue-8ce75287"></a> Receiver/Controller/Agent terminology. <a href="https://github.com/webscreens/openscreenprotocol/issues/144">&lt;https://github.com/webscreens/openscreenprotocol/issues/144></a></p>
   <h2 class="heading settled" data-level="2" id="requirements"><span class="secno">2. </span><span class="content">Requirements</span><a class="self-link" href="#requirements"></a></h2>
   <h3 class="heading settled" data-level="2.1" id="requirements-presentation-api"><span class="secno">2.1. </span><span class="content">Presentation API Requirements</span><a class="self-link" href="#requirements-presentation-api"></a></h3>
   <ol>
    <li data-md>
     <p>A controlling user agent must be able to discover the presence of a
presentation display connected to the same IPv4 or IPv6 subnet and reachable
by IP multicast.</p>
    <li data-md>
     <p>A controlling user agent must be able to obtain the IPv4 or IPv6 address of
the display, a friendly name for the display, and an IP port number for
establishing a network transport to the display.</p>
    <li data-md>
     <p>A controlling user agent must be able to determine if the receiver is
reasonably capable of rendering a specific <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-presentation-request-url" id="ref-for-dfn-presentation-request-urlâ ">presentation request URL</a>.</p>
    <li data-md>
     <p>A controlling user agent must be able to start a new presentation on a receiver given a <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-presentation-request-url" id="ref-for-dfn-presentation-request-urlâ¡">presentation request URL</a> and <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-presentation-id" id="ref-for-dfn-presentation-id">presentation ID</a>.</p>
    <li data-md>
     <p>A controlling user agent must be able to create a new <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/presentation-api/#presentationconnection" id="ref-for-presentationconnection">PresentationConnection</a></code> to an existing presentation on the
receiver, given its <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-presentation-request-url" id="ref-for-dfn-presentation-request-urlâ¢">presentation request URL</a> and <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-presentation-id" id="ref-for-dfn-presentation-idâ ">presentation ID</a>.</p>
    <li data-md>
     <p>It must be possible to close a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/presentation-api/#presentationconnection" id="ref-for-presentationconnectionâ ">PresentationConnection</a></code> between a
controller and a presentation, and signal both parties with the
reason why the connection was closed.</p>
    <li data-md>
     <p>Multiple controllers must be able to connect to a single presentation
simultaneously, possibly from from one or more <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-controlling-user-agent" id="ref-for-dfn-controlling-user-agentâ ">controlling user agents</a>.</p>
    <li data-md>
     <p>Messages sent by the controller must be delivered to the presentation (or
vice versa) in a reliable and in-order fashion.</p>
    <li data-md>
     <p>If a message cannot be delivered, then the controlling user agent must be
able to signal the receiver (or vice versa) that the connection should be
closed with reason <code>error</code>.</p>
    <li data-md>
     <p>The controller and presentation must be able to send and receive <code>DOMString</code> messages (represented as <code>string</code> type in ECMAScript).</p>
    <li data-md>
     <p>The controller and presentation must be able to send and receive binary
messages (represented as <code>Blob</code> objects in HTML5, or <code>ArrayBuffer</code> or <code>ArrayBufferView</code> types in ECMAScript).</p>
    <li data-md>
     <p>The controlling user agent must be able to signal to the receiver to
terminate a presentation, given its <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-presentation-request-url" id="ref-for-dfn-presentation-request-urlâ£">presentation request URL</a> and <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-presentation-id" id="ref-for-dfn-presentation-idâ¡">presentation
ID</a>.</p>
    <li data-md>
     <p>The receiver must be able to signal all connected controlling user agents
when a presentation is terminated.</p>
   </ol>
   <h3 class="heading settled" data-level="2.2" id="requirements-remote-playback"><span class="secno">2.2. </span><span class="content">Remote Playback API Requirements</span><a class="self-link" href="#requirements-remote-playback"></a></h3>
   <ol>
    <li data-md>
     <p>A <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-controlling-user-agent" id="ref-for-dfn-controlling-user-agentâ¡">controlling user agent</a> must be able to find out whether there is at
least one compatible <a data-link-type="dfn" href="https://w3c.github.io/remote-playback/#dfn-remote-playback-devices" id="ref-for-dfn-remote-playback-devicesâ ">remote playback device</a> available for a given <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/media.html#htmlmediaelement" id="ref-for-htmlmediaelement">HTMLMediaElement</a></code>, both instantaneously and continuously.</p>
    <li data-md>
     <p>A controlling user agent must be able to to <a data-link-type="dfn" href="https://w3c.github.io/remote-playback/#dfn-initiate-remote-playback" id="ref-for-dfn-initiate-remote-playback">initiate remote playback</a> of
an <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/media.html#htmlmediaelement" id="ref-for-htmlmediaelementâ ">HTMLMediaElement</a></code> to a compatible remote playback device.</p>
    <li data-md>
     <p>The controlling user agent must be able send media sources as URLs and text
tracks from an <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/media.html#htmlmediaelement" id="ref-for-htmlmediaelementâ¡">HTMLMediaElement</a></code> to a compatible remote playback device.</p>
    <li data-md>
     <p>During remote playback, the controlling user agent and the remote playback
device must be able to synchronize the <a data-link-type="dfn" href="https://w3c.github.io/remote-playback/#dfn-media-element-state" id="ref-for-dfn-media-element-state">media element state</a> of the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/media.html#htmlmediaelement" id="ref-for-htmlmediaelementâ¢">HTMLMediaElement</a></code>.</p>
    <li data-md>
     <p>During remote playback, either the controlling user agent or the
remote playback device must be able to disconnect from the other party.</p>
    <li data-md>
     <p>The controlling user agent should be able to pass locale and text
direction information to the remote playback device to assist in rendering
text during remote playback.</p>
   </ol>
   <h3 class="heading settled" data-level="2.3" id="requirements-non-functional"><span class="secno">2.3. </span><span class="content">Non-Functional Requirements</span><a class="self-link" href="#requirements-non-functional"></a></h3>
   <ol>
    <li data-md>
     <p>It should be possible to implement an Open Screen presentation display using
modest hardware requirements, similar to what is found in a low end
smartphone, smart TV or streaming device. See the <a href="device_specs.md">Device
Specifications</a> document for expected presentation display
hardware specifications.</p>
    <li data-md>
     <p>It should be possible to implement an Open Screen controlling user agent on a
low-end smartphone. See the <a href="device_specs.md">Device Specifications</a> document
for expected controlling user agent hardware specifications.</p>
    <li data-md>
     <p>The discovery and connection protocols should minimize power consumption,
especially on the controlling user agent which is likely to be battery
powered.</p>
    <li data-md>
     <p>The protocol should minimize the amount of information provided to a passive
network observer about the identity of the user, activity on the controlling
user agent and activity on the receiver.</p>
    <li data-md>
     <p>The protocol should prevent passive network eavesdroppers from learning
presentation URLs, presentation IDs, or the content of presentation messages
passed between controllers and presentations.</p>
    <li data-md>
     <p>The protocol should prevent active network attackers from impersonating a
display and observing or altering data intended for the controller or
presentation.</p>
    <li data-md>
     <p>The controlling user agent should be able to discover quickly when a
presentation display becomes available or unavailable (i.e., when it connects
or disconnects from the network).</p>
    <li data-md>
     <p>The controlling user agent should present sensible information to the user
when a protocol operation fails.  For example, if a controlling user agent is
unable to start a presentation, it should be possible to report in the
controlling user agent interface if it was a network error, authentication
error, or the presentation content failed to load.</p>
    <li data-md>
     <p>The controlling user agent should be able to remember authenticated
presentation displays.  This means it is not required for the user to
intervene and re-authenticate each time the controlling user agent connects
to a pre-authenticated display.</p>
    <li data-md>
     <p>Message latency between the controller and a presentation should be minimized
to permit interactive use.  For example, it should be comfortable to type in
a form in the controller and have the text appear in the presentation in real
time.  Real-time latency for gaming or mouse use is ideal, but not a
requirement.</p>
    <li data-md>
     <p>The controlling user agent initiating a presentation should communicate its
preferred locale to the receiver, so it can render the presentation content
in that locale.</p>
    <li data-md>
     <p>It should be possible to extend the control protocol (above the discovery and
transport levels) with optional features not defined explicitly by the
specification, to facilitate experimentation and enhancement of the base
APIs.</p>
   </ol>
   <h2 class="heading settled" data-level="3" id="discovery"><span class="secno">3. </span><span class="content">Discovery with mDNS</span><a class="self-link" href="#discovery"></a></h2>
   <p>Agents may discover one another using <a data-link-type="biblio" href="#biblio-rfc6763">DNS-SD</a> over <a data-link-type="biblio" href="#biblio-rfc6762">mDNS</a>.
To do so, agents must use the service name "_openscreen._udp.local".</p>
   <p class="issue" id="issue-56c2cd35"><a class="self-link" href="#issue-56c2cd35"></a> Define suspend and resume behavior for discovery protocol. <a href="https://github.com/webscreens/openscreenprotocol/issues/107">&lt;https://github.com/webscreens/openscreenprotocol/issues/107></a></p>
   <p>Advertising Agents must use an instance name that is a prefix of the agentâs
display name. If the instance name is not the complete display name (if it has
been truncated), it must be terminated by a null character.  It is prefix so
that the name displayed to the user pre-verification can be verified later.  It
is terminated by a null character in the case of truncation so that the
listening agent knows it has been truncated.  This complexity is necessary to
all for display names that exceed the size allowed in an instance name and for
such (possibly  truncated) display names to be visible to the user sooner
(before a QUIC connection is made).  Listening agents must treat instance names
as unverified and must verify that the instance name is a prefix of the verified
display name before showing the user a verified display name.</p>
   <p>Agents should use the complete display name to the user rather than a
truncated display name.</p>
   <p>Advertising agents must include DNS TXT records with the following
keys and values:</p>
   <dl>
    <dt data-md>fp
    <dd data-md>
     <p>The certificate fingerprint of the advertising agent.
The format of the fingerprint is defined by <a href="https://tools.ietf.org/html/rfc8122#section-5">RFC 8122 section
5</a>, excluding the
"fingerprint:" prefix and including the hash function, space, and hex-encoded
fingerprint.  The fingerprint value also functions as an ID for the agent.
All agents must support the following hash functions: "sha-256", "sha-512".
Agents must not support the following hash functions: "md2", "md5".</p>
   </dl>
   <p class="issue" id="issue-ad92979f"><a class="self-link" href="#issue-ad92979f"></a> Include cross references to the specs for these hash functions.</p>
   <dl>
    <dt data-md>mv
    <dd data-md>
     <p>An unsigned integer value that indicates that
metadata has changed.   The advertising agent must update it to a greater
value.  This signals to the listening agent that it should connect to the
advertising agent to discover updated metadata.</p>
   </dl>
   <p class="issue" id="issue-49bdd4e6"><a class="self-link" href="#issue-49bdd4e6"></a> Add examples of sample mDNS records.</p>
   <p>Future extensions to this QUIC-based protocol can use the same metadata
discovery process to indicate support for those extensions, through a
capabilities mechanism to be determined. If a future version of the Open Screen
Protocol uses mDNS but breaks compatibility with the metadata discovery process,
it should change the DNS-SD service name to a new value, indicating a new
mechanism for metadata discovery.</p>
   <h2 class="heading settled" data-level="4" id="transport"><span class="secno">4. </span><span class="content">Transport and metadata discovery with QUIC</span><a class="self-link" href="#transport"></a></h2>
   <p>If an agent wants to connect to or learn further metadata about another agent,
it initiates a <a data-link-type="biblio" href="#biblio-quic">[QUIC]</a> connection to the IP and port from the SRV record.
Prior to authentication, a message may be exchanged (such as further metadata),
but such info should be treated as unverified (such as indicating to a user that
a display name of an unauthenticated agent is unverified).</p>
   <p>The connection IDs used both by the <a data-link-type="biblio" href="#biblio-quic">[QUIC]</a> client and server should
be zero length.  If zero length connection IDs are chosen, agents are
restricted from changing IP or port without establishing a new QUIC
connection.  In such cases, clients and servers must establish a new
QUIC connection in order to change IP or port.</p>
   <p>To learn further metadata, an agent may send an agent-info-request message (see <a href="#appendix-a">Appendix A: Messages</a>) and receive back an agent-info-response message.  Any agent may
send this request at any time to learn about the state and capabilities of
another device, which are described by the <code>agent-info</code> message in the <code>agent-info-response</code>.</p>
   <p>The <code>agent-info</code> message contains the following properties:</p>
   <dl>
    <dt data-md>display-name (required)
    <dd data-md>
     <p>The display name of the agent, intended to be displayed to a user by the
 requester. The requester should indicate through the UI if the responder
 is not authenticated or if the display name changes.</p>
    <dt data-md>model-name (optional)
    <dd data-md>
     <p>If the agent is a hardware device, the model name of
the device.  This is used mainly for debugging purposes, but may be
displayed to the user of the requesting agent.</p>
    <dt data-md>capabilities (required)
    <dd data-md>
     <p>The control protocols, roles, and media types the agent supports.
Presence indicates a capability and absence indicates lack of a
capability.  Capabilities should should affect how an agent is
presented to a user, such as drawing a different icon depending on
the media types it supports.</p>
    <dt data-md>state-token (required)
    <dd data-md>
     <p>A random alphanumeric value consisting of 8 characters in the range
[0-9A-Za-z].  This value is set before the agent makes its first connection
and must be set to a new value when the agent is reset or otherwise lost all
of its state related to this protocol.</p>
   </dl>
   <p>The various capabilities have the following meanings:</p>
   <dl>
    <dt data-md>receive-audio
    <dd data-md>
     <p>The agent can generally receive audio for the control protocols it
supports.  Each control protocol can have more specific capability
mechanisms, such as support for specific URLs in the presentation
protocol.</p>
    <dt data-md>receive-video
    <dd data-md>
     <p>The agent can generally receive video for the control protocols it
supports.  Each control protocol can have more specific capability
mechanisms, such as support for specific URLs in the presentation
protocol.</p>
    <dt data-md>receive-presentation
    <dd data-md>
     <p>The agent can receive presentations using the presentation protocol.</p>
    <dt data-md>control-presentation
    <dd data-md>
     <p>The agent can control presentations using the presentation protocol.</p>
    <dt data-md>receive-remote-playback
    <dd data-md>
     <p>The agent can receive remote playback using the remote playback
protocol.</p>
    <dt data-md>control-remote-playback
    <dd data-md>
     <p>The agent can control remote playback using the remote playback
protocol.</p>
    <dt data-md>receive-streaming
    <dd data-md>
     <p>The agent can receiving streaming using the streaming protocol.</p>
    <dt data-md>send-streaming
    <dd data-md>
     <p>The agent can send streaming using the streaming protocol.</p>
   </dl>
   <p>Listening agents act as QUIC clients.  Advertising agents act as QUIC servers.</p>
   <p>If a listening agent wishes to receive messages from an advertising agent or an
advertising agent wishes to send messages to a listening agent, it may wish to
keep the QUIC connection alive.  Once neither side needs to keep the connection
alive for the purposes of sending or receiving messages, the connection should
be closed with an error code of 5139.  In order to keep a QUIC connection alive, an
agent may send an agent-status-request message, and any agent that receives an
agent-status-request message should send an agent-status-response message. Such
messages should be sent more frequently than the QUIC idle_timeout transport
parameter (see section 18 of <a data-link-type="biblio" href="#biblio-quic">[QUIC]</a>) and QUIC PING
frames should not be used.  An idle_timeout transport parameter of 25 seconds is
recommended.  The agent should behave as though a timer less than the
idle_timeout were reset every time a message is sent on a QUIC stream.  If the
timer expires, a agent-status-request message should be sent.</p>
   <p>If a client agent wishes to send messages to a server agent, the client
agent can connect to the server agent "on demand"; it does not need to
keep the connection alive.</p>
   <p class="issue" id="issue-e0955a17"><a class="self-link" href="#issue-e0955a17"></a> Define suspend and resume behavior for connection protocol. <a href="https://github.com/webscreens/openscreenprotocol/issues/108">&lt;https://github.com/webscreens/openscreenprotocol/issues/108></a></p>
   <p>The agent-info-response message and agent-status-response messages may be
extended to include additional information not defined in this spec.  If done
ad-hoc by applications and not in future specs, keys should be chosen to avoid
collision, such as by choosing large integers or long strings.  Agents must
ignore keys in the agent-info-message that it does not understand to allow
agents to easily extend this message.</p>
   <h2 class="heading settled" data-level="5" id="messages"><span class="secno">5. </span><span class="content">Messages delivery using CBOR and QUIC streams</span><a class="self-link" href="#messages"></a></h2>
   <p>Messages are serialized using <a data-link-type="biblio" href="#biblio-rfc7049">CBOR</a>.  To
send a group of messages in order, that group of messages must be sent in one
QUIC stream.  Independent groups of messages (with no ordering dependency
across groups) should be sent in different QUIC streams.  In order to put
multiple CBOR-serialized messages into the the same QUIC stream, the following
is used.</p>
   <p>For each message, the sender must write to the QUIC stream the following:</p>
   <ol>
    <li data-md>
     <p>A type key representing the type of the message, encoded as a variable-length
integer (see <a href="#appendix-a">Appendix A: Messages</a> for type keys)</p>
    <li data-md>
     <p>The message encoded as CBOR.</p>
   </ol>
   <p>If an agent receives a message for which it does not recognize a
type key, it must close the QUIC connection with an application error
code of 404 and should include the unknown type key in the reason phrase
(see <a href="https://tools.ietf.org/html/draft-ietf-quic-transport-16#section-19.4">QUIC transport section 19.4</a>).</p>
   <p>Variable-length integers are encoded in the same format as defined by <a href="https://tools.ietf.org/html/draft-ietf-quic-transport-16#section-16"> QUIC transport section 16</a>.</p>
   <p>Many messages are requests and responses, so a common format is defined for
those.  A request and a response includes a request ID which is an unsigned
integer chosen by the requester.  Responses must include the request ID of the
request they are associated with.</p>
   <p class="issue" id="issue-7a02cf11"><a class="self-link" href="#issue-7a02cf11"></a> Clarify scoping/uniqueness of request IDs. <a href="https://github.com/webscreens/openscreenprotocol/issues/139">&lt;https://github.com/webscreens/openscreenprotocol/issues/139></a></p>
   <h2 class="heading settled" data-level="6" id="authentication"><span class="secno">6. </span><span class="content">Authentication</span><a class="self-link" href="#authentication"></a></h2>
   <p>Each supported authentication method is implemeted via authentication messages
specific to that method.  The authentication method is explicitly specified by
the message itself.  The authentication status message is common for all authentication
methods.  Any new authentication method added must define new authentication messages.
The default authentication method is a challenge-response authentication with
auth-request-hkdf-scrypt-psk and auth-response-hkdf-scrypt-psk-result.</p>
   <p>Prior to authentication, agents exchange auth-capabilities messages specifying
pre-shared key (PSK) ease of input for the user and supported PSK input methods.
The agent with the lowest PSK ease of input presents a PSK to the user when the agent
either sends or receives an authentication request.  In case both agents have the same
PSK ease of input value, the server presents the PSK to the user.  The same pre-shared key
is used by both agents.  The agent presenting the PSK to the user is the PSK presenter,
the agent requiring the user to input the PSK is the PSK consumer.</p>
   <p>PSK ease of input is an integer in the range from 0 to 100 inclusive, where 0 means
it is not possible for the user to input PSK on this device and 100 means
that itâs easy for the user to input PSK on the device.  Supported PSK input methods
are numeric and scanning a QR-code.  Devices with non-zero PSK ease of input must
support the numeric PSK input method.</p>
   <p>For all messages and objects defined in this section, see Appendix A for
the full CDDL definitions.</p>
   <p>The default authentication method is <a href="https://tools.ietf.org/html/draft-irtf-cfrg-spake2-08">SPAKE2</a> with
the following cipher suite:</p>
   <ol>
    <li data-md>
     <p>Elliptic curve is <a href="https://tools.ietf.org/html/rfc7748#page-4">Curve25519</a>.</p>
    <li data-md>
     <p>Hash function is <a href="https://tools.ietf.org/html/rfc6234">SHA-512</a>.</p>
    <li data-md>
     <p>Key derivation function is <a href="https://tools.ietf.org/html/rfc5869">HKDF</a>.</p>
    <li data-md>
     <p>Message authentication code is <a href="https://tools.ietf.org/html/rfc2104">HMAC</a>.</p>
    <li data-md>
     <p>Password hash function is SHA-512.</p>
   </ol>
   <p>Open Screen Protocol does not use a memory-hard hash function to hash PSKs
with SPAKE2 and uses SHA-512 instead as the PSK is one-time use and
is not stored in any form.</p>
   <p>SPAKE2 provides explicit mutual authentication.</p>
   <p>This authentication method assumes the agents share a low-entropy secret,
such as a number or a short password that could be entered by a user on a
phone, a keyboard or a TV remote control.</p>
   <p>SPAKE2 is not symmetric and has two roles, Alice (A) and Bob (B).
The client acts as Alice, the server acts as Bob.</p>
   <p>The messages used in this authentication method are: auth-spake2-need-psk,
auth-spake2-message, auth-spake2-confirmation and auth-status.
SPAKE2 describes in detail how auth-spake2-message and auth-spake2-confirmation
are computed.</p>
   <p>If the PSK presenter wants to perform authentication, the PSK presenter
starts the authentication process by presenting the PSK to the user and sending
a auth-spake2-message message. When the PSK consumer receives
the auth-spake2-message message, the PSK consumer prompts the user for the PSK
input if it has not done so yet.</p>
   <p>If the PSK consumer wants to perform authentication, the PSK consumer
sends a auth-spake2-need-psk message to the PSK presenter to start authentication
process and prompts the user to input the PSK. If the PSK presenter receives
a auth-spake2-need-psk message after starting authentication from their side,
the PSK presenter ignores the auth-spake2-need-psk message.</p>
   <p>After the user inputs the PSK into the PSK consumer, the PSK consumer computes
and sends a auth-spake2-message.</p>
   <p>When either agent both knows the PSK and has received a auth-spake2-message
message, the agent computes and sends a auth-spake2-confirmation message.</p>
   <p>When either agent has received both auth-spake2-message and
auth-spake2-confirmation messages, the agent validates the confirmation message
and sends the auth-status authenticated message.</p>
   <h2 class="heading settled" data-level="7" id="control-protocols"><span class="secno">7. </span><span class="content">Control Protocols</span><a class="self-link" href="#control-protocols"></a></h2>
   <h3 class="heading settled" data-level="7.1" id="presentation-protocol"><span class="secno">7.1. </span><span class="content">Presentation Protocol</span><a class="self-link" href="#presentation-protocol"></a></h3>
   <p>This section defines the use of the Open Screen Protocol for starting,
terminating, and controlling presentations as defined by <a data-link-type="biblio" href="#biblio-presentation-api">Presentation API</a>. <a href="#presentation-api">Â§â¯7.2 Presentation API</a> defines how APIs in <a data-link-type="biblio" href="#biblio-presentation-api">Presentation API</a> map to the
protocol messages defined in this section.</p>
   <p>For all messages defined in this section, see <a href="#appendix-a">Appendix A: Messages</a> for the full
CDDL definitions.</p>
   <p class="issue" id="issue-4f0d9dbd"><a class="self-link" href="#issue-4f0d9dbd"></a> Add a capability that indicates support for the presentation protocol. <a href="https://github.com/webscreens/openscreenprotocol/issues/123">&lt;https://github.com/webscreens/openscreenprotocol/issues/123></a></p>
   <p class="issue" id="issue-905f29c0"><a class="self-link" href="#issue-905f29c0"></a> Refinements to Presentation API protocol. <a href="https://github.com/webscreens/openscreenprotocol/issues/160">&lt;https://github.com/webscreens/openscreenprotocol/issues/160></a></p>
   <p>To learn which receivers are <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-available-presentation-display" id="ref-for-dfn-available-presentation-display">available presentation displays</a> for a
particular URL or set of URLs, the controller may send a
presentation-url-availability-request message with the following values:</p>
   <dl>
    <dt data-md>urls
    <dd data-md>
     <p>A list of presentation URLs.  Must not be empty.</p>
    <dt data-md>watch-duration
    <dd data-md>
     <p>The period of time that the controller is interested in receiving updates
about their URLs, should the availability change.</p>
    <dt data-md>watch-id
    <dd data-md>
     <p>An identifier the receiver must use when sending updates about URL
availability so that the controller knows which URLs the receiver is referring
to.</p>
   </dl>
   <p>In response, the receiver should send one presentation-url-availability-response
message with the following values:</p>
   <dl>
    <dt data-md>url-availabilities
    <dd data-md>
     <p>A list of URL availability states.  Each state must correspond to the matching URL
from the request by list index.</p>
   </dl>
   <p>While the watch is valid (the watch-duration has not expired), the receivers
should send remote-playback-availability-event messages when URL availabilities change.
Such events contain the following values:</p>
   <dl>
    <dt data-md>watch-id
    <dd data-md>
     <p>The watch-id given in the presentation-url-availability-response,
used to refer to the presentation URLs whose availability has changed.</p>
    <dt data-md>url-availabilities
    <dd data-md>
     <p>A list of URL availability states.  Each state must correspond to the URLs from the
request referred to by the watch-id.</p>
   </dl>
   <p>Note that these messages are not broadcasted to all controllers. They are sent
individually to controllers that have requested availability for the URLs that
have changed in availability state within the watch duration of the original
availability request.</p>
   <p>To save power, the controller may disconnect the QUIC connection and
later reconnect to send availability requests and receive availability
responses and updates.  The QUIC connection ID may or may not be the same
when reconnecting.</p>
   <p>To start a presentation, the controller may send a
presentation-start-request message to the receiver with the following
values:</p>
   <dl>
    <dt data-md>presentation-id
    <dd data-md>
     <p>The presentation identifier</p>
    <dt data-md>url
    <dd data-md>
     <p>The selected presentation URL</p>
    <dt data-md>headers
    <dd data-md>
     <p>headers that the receiver should use to fetch the
presentationUrl.  For example, <a href="https://www.w3.org/TR/presentation-api/#establishing-a-presentation-connection">section 6.6.1</a> of
the Presentation API says that the Accept-Language header should be
provided.</p>
   </dl>
   <p>The presentation ID must follow the restrictions defined by <a href="https://www.w3.org/TR/presentation-api/#common-idioms">section 6.1</a> of the Presentation API, in that
it must consist of at least 16 ASCII characters.</p>
   <p>When the receiver receives the presentation-start-request, it should send back a
presentation-start-response message after either the presentation URL has been
fetched and loaded, or the receiver has failed to do so. If it has failed, it
must respond with the appropriate result (such as invalid-url or timeout).  If
it has succeeded, it must reply with a success result.  Additionally, the
response must include the following:</p>
   <dl>
    <dt data-md>connection-id
    <dd data-md>
     <p>An ID that both agents can use to send connection messages
to each other.  It is chosen by the receiver for ease of implementation: if
the message receiver chooses the connection-id, it may keep the ID unique
across connections, thus making message demuxing/routing easier.</p>
   </dl>
   <p>To send a presentation message, the controller or receiver may send a
presentation-connection-message with the following values:</p>
   <dl>
    <dt data-md>connection-id
    <dd data-md>
     <p>The ID from the presentation-start-response or
presentation-connection-open-response messages.</p>
    <dt data-md>message
    <dd data-md>
     <p>The presentation message data.</p>
   </dl>
   <p>To terminate a presentation, the controller may send a
presentation-termination-request message with the following values:</p>
   <dl>
    <dt data-md>presentation-id
    <dd data-md>
     <p>The ID of the presentation to terminate.</p>
    <dt data-md>reason
    <dd data-md>
     <p>The reason the presentation is being terminated.</p>
   </dl>
   <p>When a <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-receiver" id="ref-for-dfn-receiverâ¡">receiver</a> receives a presentation-termination-request, it should
send back a presentation-termination-response message to the requesting
controller.  It should also notify other controllers about the termination by sending
a presentation-termination-event message.  And it can send the same message if
it terminates a presentation without a request from a controller to do so. This
message contains the following values:</p>
   <dl>
    <dt data-md>presentation-id
    <dd data-md>
     <p>The ID of the presentation that was terminated.</p>
    <dt data-md>reason
    <dd data-md>
     <p>The reason the presentation was terminated.</p>
   </dl>
   <p>To accept incoming connections requests from controller, a receiver
must receive and process the presentation-connection-open-request
message which contains the following values:</p>
   <dl>
    <dt data-md>presentation-id
    <dd data-md>
     <p>The ID of the presentation to connect to.</p>
    <dt data-md>url
    <dd data-md>
     <p>The URL of the presentation to connect to.</p>
   </dl>
   <p>The receiver should, upon receipt of a
presentation-connection-open-request message, send back a
presentation-connection-open-response message which contains the
following values:</p>
   <dl>
    <dt data-md>result
    <dd data-md>
     <p>a code indicating success or failure, and the reason for the failure</p>
    <dt data-md>connection-id
    <dd data-md>
     <p>An ID that both agents can use to send connection messages
to each other.  It is chosen by the receiver for ease of implementation (if
the message receiver chooses the connection-id, it may keep the ID unique
across connections, thus making message demuxing/routing easier).</p>
   </dl>
   <p>A controller may terminate a connection without terminating the presentation by
sending a presentation-connection-close-request message with the following
values:</p>
   <dl>
    <dt data-md>connection-id
    <dd data-md>
     <p>The ID of the connection to close.</p>
   </dl>
   <p class="issue" id="issue-b4b59633"><a class="self-link" href="#issue-b4b59633"></a> Is a Presentation close/terminate from a controller a request/response or event? <a href="https://github.com/webscreens/openscreenprotocol/issues/124">&lt;https://github.com/webscreens/openscreenprotocol/issues/124></a></p>
   <p>The receiver should, upon receipt of a presentation-connection-close-request,
send back a presentation-connection-close-response message with the following
values:</p>
   <dl>
    <dt data-md>result
    <dd data-md>
     <p>If the close succeed or failed, and if it failed why it failed.</p>
   </dl>
   <p class="issue" id="issue-1a6da4e3"><a class="self-link" href="#issue-1a6da4e3"></a> Remove presentation-connection-close-response message. <a href="https://github.com/webscreens/openscreenprotocol/issues/138">&lt;https://github.com/webscreens/openscreenprotocol/issues/138></a></p>
   <p>The receiver may also close a connection without a request from the controller
to do so and without terminating a presentation.  If it does so, it should send
a presentation-connection-close-event to the controller with the following
values:</p>
   <dl>
    <dt data-md>connection-id
    <dd data-md>
     <p>The ID of the connection that was closed</p>
    <dt data-md>reason
    <dd data-md>
     <p>The reason the connection was closed</p>
    <dt data-md>error-message
    <dd data-md>
     <p>A debug message suitable for a log or perhaps presented to
the user with more explanation as to why it was closed.</p>
   </dl>
   <h3 class="heading settled" data-level="7.2" id="presentation-api"><span class="secno">7.2. </span><span class="content">Presentation API</span><a class="self-link" href="#presentation-api"></a></h3>
   <p>This section defines how the <a data-link-type="biblio" href="#biblio-presentation-api">Presentation API</a> uses the <a href="#presentation-protocol">Â§â¯7.1 Presentation Protocol</a>.</p>
   <p>When <a href="https://www.w3.org/TR/presentation-api/#the-list-of-available-presentation-displays">section
6.4.2</a> says "This list of presentation displays ... is populated based on an
implementation specific discovery mechanism", the <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-controlling-user-agent" id="ref-for-dfn-controlling-user-agentâ¢">controlling user agent</a> may
use the mDNS, QUIC, agent-info-request, and
presentation-url-availability-request messages defined previously in this spec
to discover receivers.</p>
   <p>When <a href="https://www.w3.org/TR/presentation-api/#the-list-of-available-presentation-displays">section
6.4.2</a> says "To further save power, ... implementation specific discovery of
presentation displays can be resumed or suspended.", the <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-controlling-user-agent" id="ref-for-dfn-controlling-user-agentâ£">controlling user
agent</a> may use the power saving mechanism defined in the previous section.</p>
   <p>When <a href="https://www.w3.org/TR/presentation-api/#starting-a-presentation-connection">section 6.3.4</a> says
"Using an implementation specific mechanism, tell U to create a receiving
browsing context with D, presentationUrl, and I as parameters.", U (the <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-controlling-user-agent" id="ref-for-dfn-controlling-user-agentâ¤">controlling user agent</a>) may send a presentation-start-request message to D
(the receiver), with I for the presentation identifier and presentationUrl for
the selected presentation URL.</p>
   <p class="issue" id="issue-733afe74"><a class="self-link" href="#issue-733afe74"></a> Once the Presentation API has text about reconnecting via an
implementation specific mechanism, quote that here and map it to a message.</p>
   <p>When <a href="https://www.w3.org/TR/presentation-api/#sending-a-message-through-presentationconnection">section
6.5.2</a> says "Using an implementation specific mechanism, transmit the contents
of messageOrData as the presentation message data and messageType as the
presentation message type to the destination browsing context", the <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-controlling-user-agent" id="ref-for-dfn-controlling-user-agentâ¥">controlling user agent</a> may send a presentation-connection-message with
messageOrData for the presentation message data.  Note that the messageType is
embedded in the encoded CBOR type and does not need an additional value in the
message.</p>
   <p>When <a href="https://www.w3.org/TR/presentation-api/#terminating-a-presentation-in-a-controlling-browsing-context">section
6.5.6</a> says "Send a termination request for the presentation to its receiving
user agent using an implementation specific mechanism", the <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-controlling-user-agent" id="ref-for-dfn-controlling-user-agentâ¦">controlling user
agent</a> may send a presentation-termination-request message.</p>
   <p>When <a href="https://www.w3.org/TR/presentation-api/#monitoring-incoming-presentation-connections">section
6.7.1</a> says "it MUST listen to and accept incoming connection requests from a
controlling browsing context using an implementation specific
mechanism", the <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-receiving-user-agent" id="ref-for-dfn-receiving-user-agentâ ">receiving user agent</a> must receive and process the
presentation-connection-open-request.</p>
   <p>When <a href="https://www.w3.org/TR/presentation-api/#monitoring-incoming-presentation-connections">section
6.7.1</a> says "Establish the connection between the controlling and receiving
browsing contexts using an implementation specific mechanism.", the <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-receiving-user-agent" id="ref-for-dfn-receiving-user-agentâ¡">receiving
user agent</a>, must send a presentation-connection-open-response message.</p>
   <h3 class="heading settled" data-level="7.3" id="remote-playback-protocol"><span class="secno">7.3. </span><span class="content">Remote Playback Protocol</span><a class="self-link" href="#remote-playback-protocol"></a></h3>
   <p>This section defines the use of the Open Screen Protocol for starting, terminating,
and controlling remote playback of media as defined by the <a data-link-type="biblio" href="#biblio-remote-playback">Remote Playback API</a>. <a href="#remote-playback-api">Â§â¯7.5 Remote Playback API</a> defines how
APIs in <a data-link-type="biblio" href="#biblio-remote-playback">Remote Playback API</a> map to the protocol messages
defined in this section.</p>
   <p>For all messages defined in this section, see Appendix A for the full
CDDL definitions.</p>
   <p class="issue" id="issue-74ff7a9d"><a class="self-link" href="#issue-74ff7a9d"></a> Add a capability that indicates support for the remote playback protocol. <a href="https://github.com/webscreens/openscreenprotocol/issues/123">&lt;https://github.com/webscreens/openscreenprotocol/issues/123></a></p>
   <p class="issue" id="issue-58529898"><a class="self-link" href="#issue-58529898"></a> Make a required/default remote playback state table. <a href="https://github.com/webscreens/openscreenprotocol/issues/148">&lt;https://github.com/webscreens/openscreenprotocol/issues/148></a></p>
   <p class="issue" id="issue-649c173f"><a class="self-link" href="#issue-649c173f"></a> Refinements to Remote Playback protocol. <a href="https://github.com/webscreens/openscreenprotocol/issues/159">&lt;https://github.com/webscreens/openscreenprotocol/issues/159></a></p>
   <p>To learn which receivers are <a data-link-type="dfn" href="https://w3c.github.io/remote-playback/#dfn-compatible-remote-playback-device" id="ref-for-dfn-compatible-remote-playback-device">compatible remote playback device</a>s (also called
available <a data-link-type="dfn" href="https://w3c.github.io/remote-playback/#dfn-remote-playback-devices" id="ref-for-dfn-remote-playback-devicesâ¡">remote playback devices</a>) for a particular URL or set of URLs, the
controller may send a remote-playback-availability-request message with the
following values:</p>
   <dl>
    <dt data-md>urls
    <dd data-md>
     <p>A list of <a data-link-type="dfn" href="https://w3c.github.io/remote-playback/#dfn-media-resources" id="ref-for-dfn-media-resources">media resources</a>.  Must not be empty.</p>
   </dl>
   <p class="issue" id="issue-9145071e"><a class="self-link" href="#issue-9145071e"></a> Remote Playback HTTP headers. <a href="https://github.com/webscreens/openscreenprotocol/issues/146">&lt;https://github.com/webscreens/openscreenprotocol/issues/146></a></p>
   <dl>
    <dt data-md>headers
    <dd data-md>
     <p>headers that the receiver should use to fetch the
urls.  For example, <a href="https://www.w3.org/TR/remote-playback/#establishing-a-connection-with-a-remote-playback-device">section 6.2.4 of
the Remote Playback API</a> says that the Accept-Language header should be
provided.</p>
    <dt data-md>watch-duration
    <dd data-md>
     <p>The period of time that the controller is interested in receiving updates
about their URLs, should the availability change.</p>
    <dt data-md>watch-id
    <dd data-md>
     <p>An identifier the receiver must use when sending updates about URL
availability so that the controller knows which URLs the receiver is referring
to.</p>
   </dl>
   <p>In response, the receiver should send a remote-playback-availability-response
message with the following values:</p>
   <dl>
    <dt data-md>url-availabilities
    <dd data-md>
     <p>A list of URL availability states.  Each state must correspond to the matching URL
from the request by list index.</p>
   </dl>
   <p>The receivers should later (up to the current time plus request
watch-duration) send remote-playback-availability-event  messages if
URL availabilities change.  Such events contain the following values:</p>
   <dl>
    <dt data-md>watch-id
    <dd data-md>
     <p>The watch-id given in the remote-playback-url-availability-response,
used to refer to the remote playback URLs whose availability has changed.</p>
    <dt data-md>url-availabilities
    <dd data-md>
     <p>A list of URL availability states.  Each state must correspond to the URLs from the
request referred to by the watch-id.</p>
   </dl>
   <p>Note that these messages are not broadcasted to all controllers. They are sent
individually to controllers that have requested availability for the URLs that
have changed in availability state within the watch duration of the original
availability request.</p>
   <p>To save power, the controller may disconnect the QUIC connection and
later reconnect to send availability requests and receive availability
responses and updates. The QUIC connection ID may or may not be the same
when reconnecting.</p>
   <p>To start remote playback, the controller may send a
remote-playback-start-request message to the receiver with the following
values:</p>
   <dl>
    <dt data-md>remote-playback-id
    <dd data-md>
     <p>An identifier that uniquely identifies the remote playback from the
controller to the receiver.  It does not need to be unique across all remote
playbacks from that controllers to all receivers nor unique across all remote
playbacks from all controllers to that receivers.</p>
    <dt data-md>urls
    <dd data-md>
     <p>The <a data-link-type="dfn" href="https://w3c.github.io/remote-playback/#dfn-media-resources" id="ref-for-dfn-media-resourcesâ ">media resources</a> that the controller has selected for playback on the
receiver.</p>
    <dt data-md>text-track-urls
    <dd data-md>
     <p>URLs of text tracks associated with the <a data-link-type="dfn" href="https://w3c.github.io/remote-playback/#dfn-media-resources" id="ref-for-dfn-media-resourcesâ¡">media resources</a>.</p>
    <dt data-md>controls
    <dd data-md>
     <p>Initial controls for modifying the initial state of the remote playback, as
defined in <a href="#remote-playback-state-and-controls">Â§â¯7.4 Remote Playback State and Controls</a>.  The controller may send
controls that are optional for the receiver to support before it knows the
receiver supports them.  If the receiver does not support them, it will
ignore them and the controller will learn that it does not support them from
the remote-playback-start-response message.</p>
   </dl>
   <p class="issue" id="issue-edcdffff"><a class="self-link" href="#issue-edcdffff"></a> Remote playback ID uniqueness. <a href="https://github.com/webscreens/openscreenprotocol/issues/147">&lt;https://github.com/webscreens/openscreenprotocol/issues/147></a></p>
   <p>When the receiver receives a remote-playback-start-request message, it should
send back a remote-playback-start-response message.  It should do so quickly,
usually before the <a data-link-type="dfn" href="https://w3c.github.io/remote-playback/#dfn-media-resources" id="ref-for-dfn-media-resourcesâ¢">media resource</a> has been loaded and instead give updates
of the progress of  loading with remote-playback-state-event messages, unless
the receiver decides to not attempt to load the resource at all.  If it chooses
not to, it must respond with the appropriate failure result (such as timeout or
invalid-url).  Additionally, the response must include the following:</p>
   <dl>
    <dt data-md>state
    <dd data-md>
     <p>The initial state of the remote playback, as defined in <a href="#remote-playback-state-and-controls">Â§â¯7.4 Remote Playback State and Controls</a>.</p>
   </dl>
   <p>If the controller wishes to modify the state of the remote playback (for
example, to pause, resume, skip, etc), it may send a
remote-playback-modify-request message with the following values:</p>
   <dl>
    <dt data-md>remote-playback-id
    <dd data-md>
     <p>The ID of the remote playback to be modified.</p>
    <dt data-md>controls
    <dd data-md>
     <p>Updated controls as defined in {#remote-playback-state-and-controls}</p>
   </dl>
   <p>When a receiver receives a remote-playback-modify-request it should send a
remote-playback-modify-response message in reply with the following values:</p>
   <dl>
    <dt data-md>state
    <dd data-md>
     <p>The updated state of the remote playback as defined in <a href="#remote-playback-state-and-controls">Â§â¯7.4 Remote Playback State and Controls</a>.</p>
   </dl>
   <p>When the state of remote playback changes without request for modification from
the controller (such as when the skips or pauses due to user user interaction on
the receiver), the receiver may send a remote-playback-state-event to the
controller.</p>
   <dl>
    <dt data-md>remote-playback-id
    <dd data-md>
     <p>The ID of the remote playback whose state has changed.</p>
    <dt data-md>state
    <dd data-md>
     <p>The updated state of the remote playback, as defined in <a href="#remote-playback-state-and-controls">Â§â¯7.4 Remote Playback State and Controls</a>.</p>
   </dl>
   <p>To terminate the remote playback, the controller may send a
remote-playback-termination-request message with the following values:</p>
   <dl>
    <dt data-md>remote-playback-id
    <dd data-md>
     <p>The ID of the remote playback to terminate.</p>
    <dt data-md>reason
    <dd data-md>
     <p>The reason the remote playback is being terminated.</p>
   </dl>
   <p>When a receiver receives a remote-playback-termination-request, it should
send back a remote-playback-termination-response message to the controller.</p>
   <p>If a receiver terminates a remote playback without a request from the controller
to do so, it must send a remote-playback-termination-event message to the
controller with the following values:</p>
   <dl>
    <dt data-md>remote-playback-id
    <dd data-md>
     <p>The ID of the remote playback that was terminated.</p>
    <dt data-md>reason
    <dd data-md>
     <p>The reason the remote playback was terminated.</p>
   </dl>
   <p>As mentioned in <a href="https://www.w3.org/TR/remote-playback/#disconnecting-from-a-remote-playback-device">Remote Playback
API section 6.2.7</a>, terminating the remote playback means the controller is no
longer controlling the remote playback and does not necessarily stop media from
rendering on the receiver.  Whether or not the receiver stops rendering media depends
upon the implementation of the receiver.</p>
   <h3 class="heading settled" data-level="7.4" id="remote-playback-state-and-controls"><span class="secno">7.4. </span><span class="content">Remote Playback State and Controls</span><a class="self-link" href="#remote-playback-state-and-controls"></a></h3>
   <p>In order for the controller and receiver to stay in sync with regards to the
state of the remote playback, the controller may send controls to modify the state
(for example, via the remote-playback-modify-request message) and the receiver
may send updates about state changes (for example, via the
remote-playback-state-event message).</p>
   <p>The controls sent by the controller include the following individual control
values, each of which is optional.  This allows the controller to change one
control value or many control values at once without having to specify all
control values every time.  A non-present control value indicates no change.  A
present control value indicates the change defined below. These controls
intentionally mirror settable attributes and methods of the <a href="https://html.spec.whatwg.org/multipage/media.html#htmlmediaelement" id="termref-for-">HtmlMediaElement</a>.</p>
   <dl>
    <dt data-md>source
    <dd data-md>
     <p>Change the <a data-link-type="dfn" href="https://w3c.github.io/remote-playback/#dfn-media-resources" id="ref-for-dfn-media-resourcesâ£">media resource</a> URL. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-src">HtmlMediaElement.src</a> for more details. Must not be used in the initial controls of the
remote-playback-start-request message (which already contains a list of URLs).</p>
    <dt data-md>preload
    <dd data-md>
     <p>Set how aggressively to preload media. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-preload">HtmlMediaElement.preload</a> for more details. Should only be used in the initial controls of the
remote-playback-start-request message or when the source is changed.  If not
set in the initial controls, it is left to the receiver to decide.  This is
optional for the receiver to support and if not supported, the receiver will
behave as though it were never set.</p>
    <dt data-md>loop
    <dd data-md>
     <p>Set whether or not to loop media. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-loop">HtmlMediaElement.loop</a> for more details. Should only be used in the initial control of the
remote-playback-start-request.  If not set in the initial controls, it is
assumed to be false.</p>
    <dt data-md>paused
    <dd data-md>
     <p>If true, pause; if false, resume. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-pause">HtmlMediaElement.pause()</a>.
and <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-play">HtmlMediaElement.play()</a> for more details.  If not set in the initial controls, it is left to the
receiver to decide.</p>
    <dt data-md>muted
    <dd data-md>
     <p>If true, mute; if false, unmute. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-muted">HtmlMediaElement.muted</a> for more details.  If not set in the initial controls, it is left to the
receiver to decide.</p>
    <dt data-md>volume
    <dd data-md>
     <p>Set the audio volume in the range from 0.0 to 1.0 inclusive. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-volume">HtmlMediaElement.volume</a> for more details.  If not set in the initial controls, it is left to the
receiver to decide.</p>
    <dt data-md>seek
    <dd data-md>
     <p>Seek to a precise time. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-currenttime">HtmlMediaElement.currentTime</a> for more details.</p>
    <dt data-md>fast-seek
    <dd data-md>
     <p>Seek to an approximate time as fast as possible. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-fastseek">HtmlMediaElement.fastSeek()</a> for more details.</p>
    <dt data-md>playback-rate
    <dd data-md>
     <p>Set the rate a which the media plays. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-playbackrate">HtmlMediaElement.playbackRate</a> for more details.  If not set in the initial controls, it is left to the
receiver to decide.  This is optional for the receiver to support and if not
supported, the receiver will behave as though it were never set.</p>
    <dt data-md>poster
    <dd data-md>
     <p>Set the URL of an image to show when video data is not available. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-poster">HtmlMediaElement.poster</a> for more details. If not set in the initial controls, no poster is used and
the receiver can choose what to render when video data is unavailable.  This
is optional for the receiver to support and if not supported, the receiver
will behave as though it were never set.</p>
    <dt data-md>enabled-audio-track-ids
    <dd data-md>
     <p>Enable included audio tracks by ID and disable all other audio tracks. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-audiotracks">HtmlMediaElement.audioTracks</a> for more details.</p>
    <dt data-md>select-video-track-id
    <dd data-md>
     <p>Select the given video track by ID and unselect all other video tracks. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-videotracks">HtmlMediaElement.videoTracks</a> for more details.</p>
    <dt data-md>added-text-tracks
    <dd data-md>
     <p>Add text tracks with the given kinds, labels, and languages. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-addtexttrack">HtmlMediaElement.addTextTrack</a> for more details.  This is optional for the receiver to support and if not
supported, the receiver will behave as though it were never set.</p>
    <dt data-md>changed-text-tracks
    <dd data-md>
     <p>Change text tracks by ID.  All other text tracks are left
unchanged.  Set the mode, add cues, and remove cues by id. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-texttracks">HtmlMediaElement.textTracks</a> for more details.  Note that future specifications or extensions to this
specifications are expected to add new properties to the text-track-cue
(such as text size, alignment, position, etc).  Adding and removing
cues is optional for the receiver to support and if not supported, the
receiver will behave as though no cues were added or removed (both adding
and removing are indicated via the support for "added-cues").  As specified in <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-texttracks">HtmlMediaElement.textTracks</a>,
if a cue ID is invalid (removing an un-added ID or adding an ID twice, for example),
the receiver may reject the text track change.</p>
   </dl>
   <p class="issue" id="issue-6098c204"><a class="self-link" href="#issue-6098c204"></a> Add a table for whether itâs required and what the default is.</p>
   <p>The states sent by the receiver include the following individual state values,
each of which is optional.  This allows the receiver to update the controller
about more than one state value at once without having to specify all
state values every time.  A non-present state value indicates the state has not
changed.</p>
   <dl>
    <dt data-md>supports
    <dd data-md>
     <p>The controls the receiver supports.  These may differ for different <a data-link-type="dfn" href="https://w3c.github.io/remote-playback/#dfn-media-resources" id="ref-for-dfn-media-resourcesâ¤">media
resource</a>s and should not changes unless the <a data-link-type="dfn" href="https://w3c.github.io/remote-playback/#dfn-media-resources" id="ref-for-dfn-media-resourcesâ¥">media resource</a> changes.
The default is empty (support for nothing)
for the initial state in the remote-playback-start-response message.</p>
    <dt data-md>source
    <dd data-md>
     <p>The current <a data-link-type="dfn" href="https://w3c.github.io/remote-playback/#dfn-media-resources" id="ref-for-dfn-media-resourcesâ¦">media resource</a> URL. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-currentsrc">HtmlMediaElement.currentSrc</a>.
Must be present in the initial state in the remote-playback-start-response message.</p>
    <dt data-md>loading
    <dd data-md>
     <p>The state of network activity for loading the <a data-link-type="dfn" href="https://w3c.github.io/remote-playback/#dfn-media-resources" id="ref-for-dfn-media-resourcesâ§">media resource</a>. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-networkstate">HtmlMediaElement.networkState</a>.
The default is empty (NETWORK_EMPTY)
for the initial state in the remote-playback-start-response message.</p>
    <dt data-md>loaded
    <dd data-md>
     <p>The state of the loaded media (whether enough is loaded to play). See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-readystate">HtmlMediaElement.readyState</a>.
The default is nothing (HAVE_NOTHING)
for the initial state in the remote-playback-start-response message.</p>
    <dt data-md>error
    <dd data-md>
     <p>A major error occurred which prevents the remote playback from continuing. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-error">HtmlMediaElement.error</a> and <a href="https://html.spec.whatwg.org/multipage/media.html#concept-mediaerror-code">HtmlMediaElement media error codes</a>.
The default is no error
for the initial state in the remote-playback-start-response message.</p>
    <dt data-md>epoch
    <dd data-md>
     <p>The "zero time" of the media timeline. See <a href="https://html.spec.whatwg.org/multipage/media.html#timeline-offset">HtmlMediaElementâs timeline offset</a> and <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-getstartdate">HtmlMediaElement.getStartDate()</a>.
The default is an unknown epoch
for the initial state in the remote-playback-start-response message.</p>
    <dt data-md>duration
    <dd data-md>
     <p>The duration of the media timeline. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-duration">HtmlMediaElement.duration</a>.
The default is an unknown duration
for the initial state in the remote-playback-start-response message.</p>
    <dt data-md>buffered-time-ranges
    <dd data-md>
     <p>The time ranges for which media has been buffered. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-buffered">HtmlMediaElement.buffered</a>.</p>
    <dt data-md>played-time-ranges
    <dd data-md>
     <p>The time ranges reached by the playback position during normal playback. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-played">HtmlMediaElement.played</a>.</p>
    <dt data-md>seekable-time-ranges
    <dd data-md>
     <p>The time ranges for which media is seekable by the controller or the receiver. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-seekable">HtmlMediaElement.seekable</a>.</p>
    <dt data-md>position
    <dd data-md>
     <p>The playback position. See <a href="https://html.spec.whatwg.org/multipage/media.html#official-playback-position">HtmlMediaElementâs official playback
position</a> and <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-currenttime">HtmlMediaElement.currentTime</a>.
The default is 0
for the initial state in the remote-playback-start-response message.</p>
    <dt data-md>playbackRate
    <dd data-md>
     <p>The current rate of playback on a scale where 1.0 is "normal speed". See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-playbackrate">HtmlMediaElement.playbackRate</a>.
The default is 1.0
for the initial state in the remote-playback-start-response message.</p>
    <dt data-md>paused
    <dd data-md>
     <p>Whether media is paused or not. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-paused">HtmlMediaElement.paused</a>.
The default is false
for the initial state in the remote-playback-start-response message.</p>
    <dt data-md>seeking
    <dd data-md>
     <p>Whether the receiver is seeking or not. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-seeking">HtmlMediaElement.seeking</a>.
The default is false
for the initial state in the remote-playback-start-response message.</p>
    <dt data-md>stalled
    <dd data-md>
     <p>If true, media is not playing because not enough media is loaded, and false otherwise. See <a href="https://html.spec.whatwg.org/multipage/media.html#event-media-stalled">HtmlMediaElement.stalled</a>.
The default is false
for the initial state in the remote-playback-start-response message.</p>
    <dt data-md>ended
    <dd data-md>
     <p>Whether media has reached the end or not. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-ended">HtmlMediaElement.ended</a>.
The default is false
for the initial state in the remote-playback-start-response message.</p>
    <dt data-md>volume
    <dd data-md>
     <p>The current volume of playback on a scale of 0.0 to 1.0. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-volume">HtmlMediaElement.volume</a>.</p>
    <dt data-md>muted
    <dd data-md>
     <p>True if audio is muted (overriding the volume value) and false otherwise.
See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-muted">HtmlMediaElement.muted</a>.</p>
    <dt data-md>resolution
    <dd data-md>
     <p>The "intrinsic width" and "intrinsic width" of the video. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-videowidth">HtmlMediaElement.videoWidth</a> and <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-videoheight">HtmlMediaElement.videoHeight</a>.</p>
    <dt data-md>audio-tracks
    <dd data-md>
     <p>The available audio tracks, which can individually enabled or disabled. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-audiotracks">HtmlMediaElement.audioTracks</a></p>
    <dt data-md>video-tracks
    <dd data-md>
     <p>The available video tracks.  Only one may be selected. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-videotracks">HtmlMediaElement.videoTracks</a></p>
    <dt data-md>text-tracks
    <dd data-md>
     <p>The available text tracks, which can be individually shown, hidden, or disabled. See <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-videotracks">HtmlMediaElement.textTracks</a>.
The controller can also add cues to and remove cues from text tracks.</p>
   </dl>
   <p>All times, time ranges, and durations (such as position, duration, and
seekable-time-ranges) used above use a common media-time value (see Appendix A)
which includes a time scale.  This allows time values which work on different
time scales to be expressed without loss of precision.  The scale is represented
in hertz, such as 90000 for 90000hz, a common time scale for video.</p>
   <h3 class="heading settled" data-level="7.5" id="remote-playback-api"><span class="secno">7.5. </span><span class="content">Remote Playback API</span><a class="self-link" href="#remote-playback-api"></a></h3>
   <p>This section defines how the <a data-link-type="biblio" href="#biblio-remote-playback">Remote Playback API</a> uses the
messages defined in <a href="#remote-playback-protocol">Â§â¯7.3 Remote Playback Protocol</a>.</p>
   <p>When <a href="https://www.w3.org/TR/remote-playback/#the-list-of-available-remote-playback-devices">section
6.2.1.2</a> says "This list contains remote playback devices and is populated
based on an implementation specific discovery mechanism" and <a href="https://www.w3.org/TR/remote-playback/#the-list-of-available-remote-playback-devices">section
6.2.1.4</a> says "Retrieve available remote playback devices (using an
implementation specific mechanism)", the user agent may use the
mDNS, QUIC, agent-info-request, and remote-playback-availability messages
defined previously in this spec to discover <a data-link-type="dfn" href="https://w3c.github.io/remote-playback/#dfn-remote-playback-devices" id="ref-for-dfn-remote-playback-devicesâ¢">remote playback devices</a>.  The
remote-playback-availability urls must contain the <a data-link-type="dfn" href="https://w3c.github.io/remote-playback/#dfn-availability-sources-set" id="ref-for-dfn-availability-sources-set">availability sources set</a>.</p>
   <p>When <a href="https://www.w3.org/TR/remote-playback/#establishing-a-connection-with-a-remote-playback-device">section
6.2.4</a> says "Request connection of remote to device. The implementation of this
step is specific to the user agent." and  "Synchronize the current media element
state with the remote playback state", the user agent may send the
remote-playback-start-request message to start remote playback.  The
remote-playback-start-request urls must contain the <a data-link-type="dfn" href="https://w3c.github.io/remote-playback/#dfn-remote-playback-source" id="ref-for-dfn-remote-playback-source">remote playback source</a>.
The current <a data-link-type="biblio" href="#biblio-remote-playback">Remote Playback API</a> only allows a single source,
but the protocol allows for several and future versions of <a data-link-type="biblio" href="#biblio-remote-playback">Remote Playback API</a> may allow for several.</p>
   <p>When <a href="https://www.w3.org/TR/remote-playback/#establishing-a-connection-with-a-remote-playback-device">section
6.2.4</a> says "The mechanism that is used to connect the user agent with the
remote playback device and play the remote playback source is an implementation
choice of the user agent. The connection will likely have to provide a two-way
messaging abstraction capable of carrying media commands to the remote playback
device and receiving media playback state in order to keep the media element
state and remote playback state in sync", the user agent may send
remote-playback-modify-request messages to change the remote playback state
based on changes to the local media element and receive
remote-playback-modify-response and remote-playback-state-event messages to
change the local media element based on changes to the remote playback state.</p>
   <p class="issue" id="issue-156f1d74"><a class="self-link" href="#issue-156f1d74"></a> Algorithm for what messages to send when local/remote media element changes. <a href="https://github.com/webscreens/openscreenprotocol/issues/158">&lt;https://github.com/webscreens/openscreenprotocol/issues/158></a></p>
   <p>When <a href="https://www.w3.org/TR/remote-playback/#establishing-a-connection-with-a-remote-playback-device">section
6.2.7</a> says "Request disconnection of remote from the device. The
implementation of this step is specific to the user agent.", the controlling
user agent may send the remote-playback-termination-request message.</p>
   <h2 class="heading settled" data-level="8" id="streaming-protocol"><span class="secno">8. </span><span class="content">Streaming Protocol</span><a class="self-link" href="#streaming-protocol"></a></h2>
   <p>This section defines the use of the Open Screen Protocol for streaming
media from a media sender to a media receiver.</p>
   <h3 class="heading settled" data-level="8.1" id="streaming-capabilities"><span class="secno">8.1. </span><span class="content">Capabilities</span><a class="self-link" href="#streaming-capabilities"></a></h3>
    If the advertiser is already authenticated, the requester has the ability to
request additional information by sending an streaming-capabilities-request
message, and receive back a streaming-capabilities-response message with the
following properties: 
   <dl>
    <dt data-md>receive-audio (required)
    <dd data-md>
     <p>A list of capabilities for receiving audio. For an explanation of fields, see below.</p>
    <dt data-md>receive-video (required)
    <dd data-md>
     <p>A list of capabilities for receiving video. For an explanation of fields, see below.</p>
    <dt data-md>receive-data (required)
    <dd data-md>
     <p>A list of arbitrary data formats the device supports
for receiving data.</p>
   </dl>
   <p>The format type is used as the basis for audio, video, and data capabilities.
Formats are composed of the following properties:</p>
   <dl>
    <dt data-md>name (required)
    <dd data-md>
     <p>The name of the format. Expected values include "vp8", "h264", "opus."</p>
    <dt data-md>parameters (required)
    <dd data-md>
     <p>A list of (key, value) parameters that can be used to pass fields that are
properties of a specific format, and not shared by other formats of that type
(audio, video, etc.).</p>
   </dl>
   <p>Audio capabilities are composed of the above format type, with the following
additional fields:</p>
   <dl>
    <dt data-md>max-audio-channels (optional)
    <dd data-md>
     <p>An optional field indicating the maximum amount of audio
channels the receiver is capable of supporting. Default value is "2," meaning
a stereo speaker channel setup.</p>
    <dt data-md>min-bit-rate (optional)
    <dd data-md>
     <p>An optional field indicating the minimum audio bit rate that
the receiver can handle, in kilobits per second. Default is no minimum.</p>
   </dl>
   <p>Video capabilities are similarly composed of the above format type, with the
following additional fields:</p>
   <dl>
    <dt data-md>max-resolution (optional)
    <dd data-md>
     <p>An optional field indicating the maximum video-resolution (width, height)
that the receiver is capable of processing. Default is no maximum.</p>
    <dt data-md>max-frames-per-second (optional)
    <dd data-md>
     <p>An optional field indicating the maximum frames-per-second the receiver is
capable of processing. Default is no maximum.</p>
    <dt data-md>max-pixels-per-second (optional)
    <dd data-md>
     <p>An optional field indicating the maximum pixels-per-second the receiver is
capable of processing, in pixels per second. Default is no maximum.</p>
    <dt data-md>min-video-bit-rate (optional)
    <dd data-md>
     <p>An optional field indicating the minimum video bit rate the device is
capable of processing, in kilobits per second. Default is no minimum.</p>
    <dt data-md>aspect-ratio (optional)
    <dd data-md>
     <p>An optional field indicating what its ideal aspect ratio is, e.g. a 16:10
display could return this value as 1.6 to indicate its preferred content
scaling. Default is none.</p>
    <dt data-md>color-profiles (optional)
    <dd data-md>
     <p>An optional field indicating what color profiles are understood.
The listener may use these values to determine how to encode
video. Some examples include: sRGBv4, Rec709, DciP3. The default value is sRGBv4.</p>
    <dt data-md>native-resolutions (optional)
    <dd data-md>
     <p>An optional field indicating what video-resolutions the receiver supports and
considers to be "native," meaning that scaling is not required.
The default value is none.</p>
    <dt data-md>supports-scaling (optional)
    <dd data-md>
     <p>A optional boolean field indicating whether the receiver can scale content
provided in a video-resolution not listed in the native-resolutions list
(if provided) or of a different aspect ratio. The default value is true.</p>
   </dl>
   <h3 class="heading settled" data-level="8.2" id="streaming-sessions"><span class="secno">8.2. </span><span class="content">Sessions</span><a class="self-link" href="#streaming-sessions"></a></h3>
   <p>TODO</p>
   <h3 class="heading settled" data-level="8.3" id="streaming-audio"><span class="secno">8.3. </span><span class="content">Audio</span><a class="self-link" href="#streaming-audio"></a></h3>
   <p>Senders may send audio to receivers by sending audio-frame messages (see <a href="#appendix-a">Appendix A: Messages</a>) with the following keys and values.  An audio frame message
contains a set of encoded audio samples for a range of time. A series of
encoded audio frames that share a codec, codec parameters and a timeline form an
audio encoding.</p>
   <p>Unlike most Open Screen Protocol messages, this one uses an
array-based grouping rather than a struct-based grouping.  For
required fields, this allows for a more efficient use of bytes on the
wire, which is important for streaming audio because the payload is
typically so small and every byte of overhead is relatively large.  In
order to accomodate optional values in the array-based grouping, one
optional field in the array is used to hold all optional values in a
struct-based grouping.  This will hopefully provide a good balance of
efficiency and flexibility.</p>
   <p>To allow for audio frames to be sent out of order, they should be sent in
separate QUIC streams.</p>
   <dl>
    <dt data-md>encoding-id
    <dd data-md>
     <p>Identifies the media encoding to which this audio frame belongs.  This can be
used to reference properties of the encoding (from the
audio-encoding-offer message) such as the codec, codec properties,
time scale (aka clock rate or sample rate), and default duration.
Referencing properties of the encoding through the encoding id
helps to avoid sending duplicate information in every frame.</p>
    <dt data-md>start-time
    <dd data-md>
     <p>Identifies the beginning of the time range of the audio frame.  The time
scale is inferred from the properties of the encoding (from the
audio-encoding-offer).  The end time can be inferred from the
start time and duration.</p>
    <dt data-md>duration
    <dd data-md>
     <p>If present, the duration of the audio frame.  The time
scale is inferred from the properties of the encoding.  Likewise, if not
present, the duration is inferred from the properties of the encoding.</p>
    <dt data-md>sync-time
    <dd data-md>
     <p>If present, a time used to synchronize the start time of this audio frame (and
thus, this encoding) with that of other media encodings on
different timelines.  It may be wall clock time, but it need not
be; it can be any clock chosen by the sender.</p>
    <dt data-md>payload
    <dd data-md>
     <p>The data.  The type of data is inferred from the properties of the encoding.</p>
   </dl>
   <h3 class="heading settled" data-level="8.4" id="streaming-video"><span class="secno">8.4. </span><span class="content">Video</span><a class="self-link" href="#streaming-video"></a></h3>
   <p>Senders may send video to receivers by sending video-frame messages (see <a href="#appendix-a">Appendix A: Messages</a>) with the following keys and values.  A video frame message
contains an encoded video frame (an encoded image) at a specific point in time
or over a specfic time range (if the duration is known).  A series of encoded
video frames that share a codec, codec parameters and a timeline form a video
encoding.</p>
   <p>To allow for video frames to be sent out of order, they may be sent in
separate QUIC streams.  If the encoding is a long chain of encoded video frames
dependent on the previous one back until an independent frame, it may make sense
to send them in a single QUIC stream starting at the indepdendent frame and
ending at the last dependent frame.</p>
   <dl>
    <dt data-md>encoding-id
    <dd data-md>
     <p>Identifies the media encoding to which this video frame belongs.  This can be
used to reference properties of the encoding such as the codec, codec
properties, time scale, and default rotation.  Referencing properties of the
encoding through the encoding id helps to avoid sending duplicate
information in every frame.</p>
    <dt data-md>sequence-number
    <dd data-md>
     <p>Identifies the frame and its order in the encoding.
Within an encoding, larger sequence numbers mean later start times.
Within an encoding, gaps in sequence numbers mean frames are missing.</p>
    <dt data-md>depends-on
    <dd data-md>
     <p>If present, the sequence numbers of the frames this frame depends on.
If a sequence numbers is negative, it is treated as a relative sequence numbers
and the sequence numbers is calculated by adding it to the sequence number of this frame.
If empty, this is an independent frame (a key frame).
If not present, the default value is [-1].</p>
    <dt data-md>start-time
    <dd data-md>
     <p>Identifies the beginning of the time range of the video frame.  The time
scale is inferred from the properties of the encoding (from the
video-encoding-offer).  The end time can be inferred from the
start time and duration.</p>
    <dt data-md>duration
    <dd data-md>
     <p>If present, the duration of the video frame.  The time
scale is inferred from the properties of the encoding.  If not
present, that means duration is unknown.</p>
    <dt data-md>sync-time
    <dd data-md>
     <p>If present, a time used to synchronize the start time of this frame (and
thus, this encoding) with that of other media encodings on different
timelines.</p>
    <dt data-md>rotation
    <dd data-md>
     <p>If present, indicates how the frame should be rotated after decoding but
before rendering.  Rotation is clockwise in increments of 90 degrees.
The default is 0 (no rotation).</p>
    <dt data-md>payload
    <dd data-md>
     <p>The encoded video frame (encoded image).  The codec and codec parameters are
inferred from the properties of the encoding.</p>
   </dl>
   <h3 class="heading settled" data-level="8.5" id="media-streaming-data"><span class="secno">8.5. </span><span class="content">Data</span><a class="self-link" href="#media-streaming-data"></a></h3>
   <p>Senders may send timed data to receivers by sending data-frame messages (see <a href="#appendix-a">Appendix A: Messages</a>) with the following keys and values.  A data frame message
contains an arbitrary payload that can be synchronized with and video, such as
text track data.  A series of data frames that share a data type and timeline
form a data encoding.</p>
   <p>To allow for data frames to be sent out of order, they may be sent in separate
QUIC streams, but more than one data frame may be sent in one QUIC stream if
that makes sense for a specific type of data.</p>
   <p>Text track data uses a payload type of text, a default duration of unknown, and
a timescale of 1000000 (microseconds).</p>
   <dl>
    <dt data-md>encoding-id
    <dd data-md>
     <p>Identifies the media encoding to which this data frame belongs.  This can be
used to reference properties of the encoding such as the type of data and
time scale.  Referencing properties of the encoding through the encoding id
helps to avoid sending duplicate information in every frame.</p>
    <dt data-md>sequence-number
    <dd data-md>
     <p>Identifies the frame and its order in the encoding.
Within an encoding, larger sequence numbers mean later start times.
Within an encoding, gaps in sequence numbers mean frames are missing.</p>
    <dt data-md>start-time
    <dd data-md>
     <p>Identifies the beginning of the time range of the data frame.  The time
scale is inferred from the properties of the encoding.  The end time can be
inferred from the start time and duration.</p>
    <dt data-md>duration
    <dd data-md>
     <p>If present, the duration of the data frame.  The time
scale is inferred from the properties of the encoding.  Likewise, if not
present, the duration is inferred from the properties of the encoding.</p>
    <dt data-md>sync-time
    <dd data-md>
     <p>If present, a time used to synchronize the start time of this audio frame (and
thus, this encoding) with that of other media encodings on different
timelines.</p>
    <dt data-md>payload
    <dd data-md>
     <p>The data.  The format and parameters are inferred from
the properties of the encoding.</p>
   </dl>
   <h3 class="heading settled" data-level="8.6" id="streaming-feedback"><span class="secno">8.6. </span><span class="content">Feedback</span><a class="self-link" href="#streaming-feedback"></a></h3>
   <p>The receiver can send feedback to the sender, such as key frame requests.</p>
   <p>A video key frame is requested by sending a video-request message with
the following keys and values.</p>
   <p>To allow for video frames to be sent out of order, they may be sent in separate
QUIC streams.</p>
   <dl>
    <dt data-md>encoding-id
    <dd data-md>
     <p>The encoding for which the sender should send a new key frame.</p>
    <dt data-md>sequence-number
    <dd data-md>
     <p>Gives the order in the encoding.
Within an encoding, larger sequence numbers invalidate previous ones.
A sender may ignore smaller sequence numbers after a larger one has been processed.
This it to prevent out-of-order requests from generating more key frames than necessary.</p>
    <dt data-md>highest-decoded-frame-sequence-number: uint
    <dd data-md>
     <p>If set, the sender may generate a video frame dependent on the last decoded
frame.  If not set, the sender must generate an indepdendent (key) frame.</p>
   </dl>
   <h3 class="heading settled" data-level="8.7" id="streaming-stats"><span class="secno">8.7. </span><span class="content">Stats</span><a class="self-link" href="#streaming-stats"></a></h3>
   <p>TODO</p>
   <h2 class="heading settled" data-level="9" id="requests-responses--watches"><span class="secno">9. </span><span class="content">Requests, Responses, and Watches</span><a class="self-link" href="#requests-responses--watches"></a></h2>
   <p>Multiple sub-protocols in OSP have messages that act as requests, responses,
watches, and events. Most requests have a <code>request-id</code>, and the agent that
receives the request must send exactly one reponse message in return with the
same <code>request-id</code>.  A watch request has a <code>watch-id</code>, and the agent that
receives the request may send any number of event messages in response with
the same <code>watch-id</code>, until the watch request expires.</p>
   <p><code>request-id</code> and <code>watch-id</code> values are unsigned integer IDs that are assigned
from a counter kept by each agent that starts at 1 and increments by 1 for each
ID.  Whenever an agent changes its <code>state-token</code>, it must reset its counter to 1.</p>
   <p>When an agent sees that another agent has reset its state (by virtue of
advertising a new <code>state-token</code>), it should discard any requests, responses,
watches and events for that agent.</p>
   <p class="note" role="note"><span>Note:</span> Request and watch IDs are not tied to any particular QUIC connection
between agents.  If a QUIC connection is closed, an agent should not discard
requests, responses, watches, or events related to the other party.  This allows
agents to save power by closing unused connections.</p>
   <p class="note" role="note"><span>Note:</span> Request and watch IDs are not unique across agents.  An agent can combine
a request ID with a unique identifier for the agent that sent it (like its
certificate fingerprint) to track requests across multiple agents.</p>
   <h2 class="heading settled" data-level="10" id="security-privacy"><span class="secno">10. </span><span class="content">Security and Privacy</span><a class="self-link" href="#security-privacy"></a></h2>
   <p>The Open Screen Protocol allows two networked agents to discover each other
and exchange user and application data.  As such, its security and privacy
considerations should be closely examined.  We first evaluate the protocol
itself using the W3C <a data-link-type="biblio" href="#biblio-security-privacy-questionnaire">Security and Privacy
Questionnaire</a>.  We then examine whether the security and privacy guidelines
recommended by the <a data-link-type="biblio" href="#biblio-presentation-api">Presentation API</a> and the <a data-link-type="biblio" href="#biblio-remote-playback">Remote Playback API</a> are met.  Finally we discuss recommended
mitigations that agents can use to meet these security and privacy
requirements.</p>
   <h3 class="heading settled" data-level="10.1" id="threat-models"><span class="secno">10.1. </span><span class="content">Threat Models</span><a class="self-link" href="#threat-models"></a></h3>
   <h4 class="heading settled" data-level="10.1.1" id="passive-network-attackers"><span class="secno">10.1.1. </span><span class="content">Passive Network Attackers</span><a class="self-link" href="#passive-network-attackers"></a></h4>
   <p>The Open Screen Protocol should assume that all parties that are connected to
the same LAN, either through a wired connection or through WiFi, are able to
observe all data flowing between Open Screen Protocol agents.</p>
   <p>These parties will be able collect any data exposed through unencrypted
messages, such as mDNS records and the QUIC handshakes.</p>
   <p>These parties may attempt to learn cryptographic parameters by observing data
flows on the QUIC connection, or by observing cryptographic timing.</p>
   <h4 class="heading settled" data-level="10.1.2" id="active-network-attackers"><span class="secno">10.1.2. </span><span class="content">Active Network Attackers</span><a class="self-link" href="#active-network-attackers"></a></h4>
   <p>Active attackers, such as compromised routers, will be able to manipulate data
exchanged between agents.  They can inject traffic into existing QUIC
connections and attempt to initiate new QUIC connections.  These abilities can
be used to attempt the following:</p>
   <ul>
    <li data-md>
     <p>Impersonate an agent or one already trusted by the user, in an attempt
to convince the user to authenticate to it.</p>
    <li data-md>
     <p>Connect to an agent and query its capabilities.</p>
    <li data-md>
     <p>Connect to and control a presentation or remote playback, or extract data
from the application state of the presentation or remote playback.</p>
   </ul>
   <p>One particular attack of concern is misconfigured or compromised routers that
expose local network devices (such as Open Screen Protocol agents) to the
Internet.  This vector of attack has been used by malicious parties to take
control of printers and smart TVs by connecting to local network services that
would normally be inaccessible from the Internet.</p>
   <h4 class="heading settled" data-level="10.1.3" id="denial-of-service"><span class="secno">10.1.3. </span><span class="content">Denial of Service</span><a class="self-link" href="#denial-of-service"></a></h4>
   <p>Parties with connected to the LAN may attempt to deny access to Open Screen
Protocol agents.  For example, an attacker my attempt to open
a large number of QUIC connections to an agent in an attempt to block
legitimate connections or exhaust the agentâs system resources.  They may
also multicast spurious DNS-SD records in an attempt to exhaust the cache
capacity for mDNS listeners, or to get listeners to open a large number of bogus
QUIC connections.</p>
   <h4 class="heading settled" data-level="10.1.4" id="same-origin-policy-violations"><span class="secno">10.1.4. </span><span class="content">Same-Origin Policy Violations</span><a class="self-link" href="#same-origin-policy-violations"></a></h4>
   <p>The Presentation API allows cross-origin communication between controlling pages
and presentations with the consent of each origin (through their use of the
API).  This is similar to cross-origin communication via <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#dom-window-postmessage" id="ref-for-dom-window-postmessage">postMessage()</a></code> with a <code>targetOrigin</code> of <code>*</code>.  However, the Presentation API does not convey source
origin information with each message.  Therefore, the Open Screen Protocol does
not convey origin information between its agents.</p>
   <p>The <a data-link-type="dfn" href="https://w3c.github.io/presentation-api/#dfn-presentation-id" id="ref-for-dfn-presentation-idâ¢">presentation ID</a> carries some protection against unrestricted
cross-origin access; but, rigorous authentication of the parties connected by a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/presentation-api/#presentationconnection" id="ref-for-presentationconnectionâ¡">PresentationConnection</a></code> must be done at the application level.</p>
   <h3 class="heading settled" data-level="10.2" id="security-privacy-questions"><span class="secno">10.2. </span><span class="content">Open Screen Protocol Security and Privacy Considerations</span><a class="self-link" href="#security-privacy-questions"></a></h3>
   <h4 class="heading settled" data-level="10.2.1" id="personally-identifiable-information"><span class="secno">10.2.1. </span><span class="content">Personally Identifiable Information &amp; High-Value Data</span><a class="self-link" href="#personally-identifiable-information"></a></h4>
   <p>The following data exchanged by the protocol can be personally identifiable
and/or high value data:</p>
   <ol>
    <li data-md>
     <p>Presentation URLs and availability results</p>
    <li data-md>
     <p>Presentation IDs</p>
    <li data-md>
     <p>Presentation connection IDs</p>
    <li data-md>
     <p>Presentation connection messages</p>
    <li data-md>
     <p>Remote playback URLs</p>
    <li data-md>
     <p>Remote playback commands and status messages</p>
   </ol>
   <p>Presentation IDs are considered high value data because they can be used in
conjunction with a Presentation URL to connect to a running presentation.</p>
   <p>Presentation display friendly names, model names, and capabilities, while not
considered personally identifiable, are important to protect to prevent an
attacker from changing them or substituting other values during the discovery
and authentication process.</p>
   <p>The following data cannot be reasonably made confidential and should be
considered public and untrusted data:</p>
   <ol>
    <li data-md>
     <p>IP addresses and ports used by the Open Screen Protocol.</p>
    <li data-md>
     <p>Data advertised through mDNS, including the display name prefix, the
certificate fingerprint, and the metadata version.</p>
   </ol>
   <h4 class="heading settled" data-level="10.2.2" id="cross-origin-state"><span class="secno">10.2.2. </span><span class="content">Cross Origin State Considerations</span><a class="self-link" href="#cross-origin-state"></a></h4>
   <p>Access to origin state across browsing sessions is possible through the
Presentation API by reconnecting to a presentation that was started by a
previous session. This scenario is addressed in <a href="https://www.w3.org/TR/presentation-api/#cross-origin-access">Presentation API Â§cross-origin-access</a>.</p>
   <p>Presentation display availability and remote playback device availability are
states that are available cross-origin depending on the userâs network
context.  Exposure of this data to the Web is also discussed in <a href="https://www.w3.org/TR/presentation-api/#personally-identifiable-information">Presentation API Â§personally-identifiable-information</a> and <a href="https://www.w3.org/TR/remote-playback/#personally-identifiable-information">Remote Playback API Â§personally-identifiable-information</a>.</p>
   <h4 class="heading settled" data-level="10.2.3" id="origin-access-devices"><span class="secno">10.2.3. </span><span class="content">Origin Access to Other Devices</span><a class="self-link" href="#origin-access-devices"></a></h4>
   <p>By design, the Open Screen Protocol allows access to presentation displays and
remote playback devices from the Web.  By implementing the protocol, these
devices are knowingly making themselves available to the Web and should be
designed accordingly.</p>
   <p>Below, we discuss mitigation steps to prevent malicious use of these devices.</p>
   <h4 class="heading settled" data-level="10.2.4" id="incognito-mode"><span class="secno">10.2.4. </span><span class="content">Incognito Mode</span><a class="self-link" href="#incognito-mode"></a></h4>
   <p>The Open Screen Protocol does not distinguish between the user agentâs normal
browsing and incognito modes, and agents that follow the specification
behave identically regardless of which mode is in use.</p>
   <p>Itâs recommended that user agents use separate authentication contexts and QUIC
connections for normal and incognito profiles from the same user agent instance.
This prevents Open Screen agents from correlating activity among profiles
belonging to the same user (both normal and incognito).</p>
   <h4 class="heading settled" data-level="10.2.5" id="persistent-state"><span class="secno">10.2.5. </span><span class="content">Persistent State</span><a class="self-link" href="#persistent-state"></a></h4>
   <p>An agent is likely to persist the identity of agents that have successfully
completed <a href="#authentication">Â§â¯6 Authentication</a>.  This may include the public key fingerprints,
metadata versions, and metadata for those parties.</p>
   <p>However, this data is not normally exposed to the Web, only through the native
UI of the user agent during the display selection or display authentication
process.  It can be an implementation choice whether the user agent clears or
retains this data when the user clears browsing data.</p>
   <p class="issue" id="issue-8bf4aa9f"><a class="self-link" href="#issue-8bf4aa9f"></a> Fate of metadata / authentication history when clearing browsing data. <a href="https://github.com/webscreens/openscreenprotocol/issues/132">&lt;https://github.com/webscreens/openscreenprotocol/issues/132></a></p>
   <h4 class="heading settled" data-level="10.2.6" id="other-considerations"><span class="secno">10.2.6. </span><span class="content">Other Considerations</span><a class="self-link" href="#other-considerations"></a></h4>
   <p>The Open Screen Protocol does not grant to the Web additional access to the
following:</p>
   <ul>
    <li data-md>
     <p>New script loading mechanisms</p>
    <li data-md>
     <p>Access to the userâs location</p>
    <li data-md>
     <p>Access to device sensors</p>
    <li data-md>
     <p>Access to the userâs local computing environment</p>
    <li data-md>
     <p>Control over the user agentâs native UI</p>
    <li data-md>
     <p>Security characteristics of the user agent</p>
   </ul>
   <h3 class="heading settled" data-level="10.3" id="presentation-api-considerations"><span class="secno">10.3. </span><span class="content">Presentation API Considerations</span><a class="self-link" href="#presentation-api-considerations"></a></h3>
   <p><a href="https://www.w3.org/TR/presentation-api/#security-and-privacy-considerations">Presentation API Â§security-and-privacy-considerations</a> place these
requirements on the Open Screen Protocol:</p>
   <ol>
    <li data-md>
     <p>Presentation URLs and presentation IDs should remain private among the
parties that are allowed to connect to a presentation, per the
cross-origin access guidelines.</p>
    <li data-md>
     <p>Controllers and receivers should be notified when connections representing
multiple user agent profiles have been made to a presentation, per the user
interface guidelines.</p>
    <li data-md>
     <p>Messaging between controllers and receivers should be authenticated and
confidential, per the guidelines for messaging between presentation
connections.</p>
   </ol>
   <p>The Open Screen Protocol addresses these considerations by:</p>
   <ol>
    <li data-md>
     <p>Requiring mutual authentication and a TLS-secured QUIC connection before
 presentation URLs, IDs, or messages are exchanged.</p>
    <li data-md>
     <p>Adding explicit messages and connection IDs for individual <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/presentation-api/#presentationconnection" id="ref-for-presentationconnectionâ¢">PresentationConnections</a></code> so that agents can track
 the number of active connections.</p>
   </ol>
   <p class="issue" id="issue-edc1d8c1"><a class="self-link" href="#issue-edc1d8c1"></a> Notify endpoints when new connection is created. <a href="https://github.com/webscreens/openscreenprotocol/issues/143">&lt;https://github.com/webscreens/openscreenprotocol/issues/143></a></p>
   <h3 class="heading settled" data-level="10.4" id="remote-playback-considerations"><span class="secno">10.4. </span><span class="content">Remote Playback API Considerations</span><a class="self-link" href="#remote-playback-considerations"></a></h3>
   <p>The <a href="https://www.w3.org/TR/remote-playback/#security-and-privacy-considerations">Remote Playback API Â§security-and-privacy-considerations</a> also state that
messaging between local and remote playback devices should also be authenticated
and confidential.</p>
   <p>This consideration is handled by requiring mutual authentication and a
TLS-secured QUIC connection before any remote playback related messages are
exchanged.</p>
   <h3 class="heading settled" data-level="10.5" id="security-mitigations"><span class="secno">10.5. </span><span class="content">Mitigation Strategies</span><a class="self-link" href="#security-mitigations"></a></h3>
   <h4 class="heading settled" data-level="10.5.1" id="local-passive-mitigations"><span class="secno">10.5.1. </span><span class="content">Local passive network attackers</span><a class="self-link" href="#local-passive-mitigations"></a></h4>
   <p>Local passive attackers may attempt to harvest data about user activities and
device capabilities using the Open Screen Protocol.  The main strategy to address
this is data minimization, by only exposing opaque public key fingerprints
before user-mediated authentication takes place.</p>
   <p>Passive attackers may also attempt timing attacks to learn the
cryptographic parameters of the TLS 1.3 QUIC connection.</p>
   <p class="issue" id="issue-84520e29"><a class="self-link" href="#issue-84520e29"></a> Review attack and mitigation considerations for TLS 1.3 <a href="https://github.com/webscreens/openscreenprotocol/issues/130">&lt;https://github.com/webscreens/openscreenprotocol/issues/130></a></p>
   <h4 class="heading settled" data-level="10.5.2" id="local-active-mitigations"><span class="secno">10.5.2. </span><span class="content">Local active network attackers</span><a class="self-link" href="#local-active-mitigations"></a></h4>
   <p>Local active attackers may attempt to impersonate a presentation display the
user would normally trust.  The <a href="#authentication">Â§â¯6 Authentication</a> step of the Open Screen
Protocol prevents a man-in-the-middle from impersonating an agent, without
knowledge of a shared secret.  However, it is possible for an attacker to
impersonate an existing, trusted display or a newly discovered display that is
not yet authenticated and try to convince the user to authenticate it.</p>
   <p>This can be addressed through a combination of techniques.  The first is
detecting and flagging attempts at impersonation; a few of the situations that
should be flagged include:</p>
   <ul>
    <li data-md>
     <p>Untrusted agents whose public key fingerprint collides with that from an
already-trusted agent that is concurrently being advertised.</p>
    <li data-md>
     <p>Untrusted agents whose friendly name differs from the one previously
advertised under a given public key fingerprint.</p>
    <li data-md>
     <p>Untrusted agents that fail the authentication challenge a certain number of times.</p>
    <li data-md>
     <p>Untrusted agents that advertise a friendly name that is similar to that from an
already-trusted agent.</p>
    <li data-md>
     <p>Already-trusted agents whose metadata provided through the <code>agent-info</code> message has changed.</p>
   </ul>
   <p>Flagging means that the user is notified of the attempt at impersonation.  In
the last case, the user should be required to re-authenticate to the
already-trusted agent to verify its identity.</p>
   <p class="issue" id="issue-d435d3a9"><a class="self-link" href="#issue-d435d3a9"></a> UI guidelines for pairing and trusted/untrusted data. <a href="https://github.com/webscreens/openscreenprotocol/issues/118">&lt;https://github.com/webscreens/openscreenprotocol/issues/118></a></p>
   <p>The second is through management of the low-entropy secret during mutual
authentication:</p>
   <ul>
    <li data-md>
     <p>Rotate the low-entropy secret to prevent brute force attacks.</p>
    <li data-md>
     <p>Use an increasing backoff to respond to authentication challenges, also to
prevent brute force attacks.</p>
    <li data-md>
     <p>Use a cryptographically sound source of entropy to generate the shared secret.</p>
    <li data-md>
     <p>Require the end user to manually type the shared secret - shown only on the
display - to prevent the user from blindly clicking through this step.</p>
   </ul>
   <p>The active attacker may also attempt to disrupt data exchanged over the QUIC
connection by injecting or modifying traffic.  These attacks should be mitigated
by a correct implementation of TLS 1.3.</p>
   <p class="issue" id="issue-84520e29â "><a class="self-link" href="#issue-84520e29â "></a> Review attack and mitigation considerations for TLS 1.3 <a href="https://github.com/webscreens/openscreenprotocol/issues/130">&lt;https://github.com/webscreens/openscreenprotocol/issues/130></a></p>
   <h4 class="heading settled" data-level="10.5.3" id="remote-active-mitigations"><span class="secno">10.5.3. </span><span class="content">Remote active network attackers</span><a class="self-link" href="#remote-active-mitigations"></a></h4>
   <p>Unfortunately, we cannot rely on network devices to fully protect Open Screen
Protocol agents, because a misconfigured firewall or NAT could expose a
LAN-connected agent to the broader Internet.  Open Screen Protocol agents
should be secure against attack from any Internet host.</p>
   <p class="issue" id="issue-7e863472"><a class="self-link" href="#issue-7e863472"></a> Mitigations for remote network attackers. <a href="https://github.com/webscreens/openscreenprotocol/issues/131">&lt;https://github.com/webscreens/openscreenprotocol/issues/131></a></p>
   <h4 class="heading settled" data-level="10.5.4" id="denial-of-service-mitigations"><span class="secno">10.5.4. </span><span class="content">Denial of service</span><a class="self-link" href="#denial-of-service-mitigations"></a></h4>
   <p>It will be difficult to completely prevent denial service of attacks that
originate on the userâs local area network.  Open Screen Protocol agents can
refuse new connections, close connections that receive too many messages, or
limit the number of mDNS records cached from a specific responder in an attempt
to allow existing activities to continue in spite of such an attack.</p>
   <h4 class="heading settled" data-level="10.5.5" id="malicious-input-mitigations"><span class="secno">10.5.5. </span><span class="content">Malicious input</span><a class="self-link" href="#malicious-input-mitigations"></a></h4>
   <p>Open Screen Protocol agents should be robust against malicious input that
attempts to compromise the target device by exploiting parsing vulnerabilities.</p>
   <p>CBOR is intended to be less vulnerable to such attacks relative to alternatives
like JSON and XML.  Still, agents should be thoroughly tested using approaches
like <a href="https://en.wikipedia.org/wiki/Fuzzing">fuzz testing</a>.</p>
   <p>Where possible, Open Screen Protocol agents (including the content rendering
components) should use defense-in-depth techniques like <a href="https://en.wikipedia.org/wiki/Sandbox_(computer_security)">sandboxing</a> to prevent vulnerabilities from gaining access to user data or leading to
persistent exploits.</p>
   <h2 class="heading settled" id="appendix-a"><span class="content">Appendix A: Messages</span><a class="self-link" href="#appendix-a"></a></h2>
   <p>The following messages are defined with <a data-link-type="biblio" href="#biblio-cddl">[CDDL]</a>. When
integer keys are used, a comment is appended to the line to indicate
the name of the field. Object definitions in this specification have this
unusual syntax to reduce the number of bytes-on-the-wire, while maintaining a
human-readable name for each key. Integer keys are used instead of object arrays
to allow for easy indexing of optional fields.</p>
   <p>Each root message (one that can be put into a
QUIC stream without being enclosed by another message) has a comment
indicating the message type key.</p>
   <p>Smaller numbers should be reserved for message that will be sent more
frequently or are very small or both and larger numbers should be
reserved for messages that are infrequently sent or large or both
because smaller type keys encode on the wire smaller.</p>
   <div class="highlight">
<pre><span></span><span class="c1">; type key 10</span>
<span class="nx">agent-info-request </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">request</span>
<span class="p">}</span>

<p><span class="c1">; type key 11</span>
<span class="nx">agent-info-response </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">response</span>
<span class="nx">  1</span><span class="p">:</span> <span class="nx">agent-info </span><span class="c1">; agent-info</span>
<span class="p">}</span></p>

<p><span class="nx">agent-info </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">0</span><span class="p">:</span> <span class="nx">text </span><span class="c1">; display-name</span>
  <span class="mi">1</span><span class="p">:</span> <span class="nx">text </span><span class="c1">; model-name</span>
  <span class="p">?</span> <span class="mi">2</span><span class="p">:</span> <span class="nx">bool </span><span class="c1">; receives-audio</span>
  <span class="p">?</span> <span class="mi">3</span><span class="p">:</span> <span class="nx">bool </span><span class="c1">; receives-video</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 12</span>
<span class="nx">agent-status-request </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">request</span>
<span class="nx">  </span><span class="p">?</span> <span class="mi">1</span><span class="p">:</span> <span class="nx">status </span><span class="c1">; status</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 13</span>
<span class="nx">agent-status-response </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">response</span>
<span class="nx">  </span><span class="p">?</span> <span class="mi">1</span><span class="p">:</span> <span class="nx">status </span><span class="c1">; status</span>
<span class="p">}</span></p>

<p><span class="nx">status </span><span class="p">=</span> <span class="p">{}</span></p>

<p><span class="nx">request </span><span class="p">=</span> <span class="p">(</span>
 <span class="mi">0</span><span class="p">:</span> <span class="nx">request-id </span><span class="c1">; request-id</span>
<span class="p">)</span></p>

<p><span class="nx">response </span><span class="p">=</span> <span class="p">(</span>
 <span class="mi">0</span><span class="p">:</span> <span class="nx">request-id </span><span class="c1">; request-id</span>
<span class="p">)</span></p>

<p><span class="nx">request-id </span><span class="p">=</span> <span class="kt">uint</span></p>

<p><span class="nx">microseconds </span><span class="p">=</span> <span class="kt">uint</span></p>

<p><span class="c1">; type key 1001</span>
<span class="nx">auth-capabilities </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">0</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; psk-ease-of-input</span>
  <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">psk-input-method</span><span class="p">]</span> <span class="c1">; psk-input-methods</span>
<span class="p">}</span></p>

<p><span class="nx">psk-input-method </span><span class="p">=</span> <span class="o">&amp;</span><span class="p">(</span>
  <span class="nx">numeric</span><span class="p">:</span> <span class="mi">0</span>
  <span class="nx">qr-code</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">)</span></p>

<p><span class="c1">; type key 1002</span>
<span class="nx">auth-spake2-need-psk </span><span class="p">=</span> <span class="p">{</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 1003</span>
<span class="nx">auth-spake2-message </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">1</span> <span class="p">:</span> <span class="nx">bytes .size 32 </span><span class="c1">; message</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 1004</span>
<span class="nx">auth-spake2-confirmation </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">1</span> <span class="p">:</span> <span class="nx">bytes .size 32 </span><span class="c1">; confirmation</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 1005</span>
<span class="nx">auth-status </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">1</span> <span class="p">:</span> <span class="nx">auth-status-result </span><span class="c1">; result</span>
<span class="p">}</span></p>

<p><span class="nx">auth-status-result </span><span class="p">=</span> <span class="o">&amp;</span><span class="p">(</span>
  <span class="nx">authenticated</span><span class="p">:</span> <span class="mi">0</span>
  <span class="nx">unknown-error</span><span class="p">:</span> <span class="mi">1</span>
  <span class="nx">timeout</span><span class="p">:</span> <span class="mi">2</span>
  <span class="nx">secret-unknown</span><span class="p">:</span> <span class="mi">3</span>
  <span class="nx">validation-took-too-long </span><span class="p">:</span> <span class="mi">4</span>
  <span class="nx">proof-invalid</span><span class="p">:</span> <span class="mi">5</span>
<span class="p">)</span></p>

<p><span class="c1">; type key 14</span>
<span class="nx">presentation-url-availability-request </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">request</span>
<span class="nx">  1</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="o">*</span> <span class="nx">text</span><span class="p">]</span> <span class="c1">; urls</span>
  <span class="mi">2</span><span class="p">:</span> <span class="nx">microseconds </span><span class="c1">; watch-duration</span>
  <span class="mi">3</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; watch-id</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 15</span>
<span class="nx">presentation-url-availability-response </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">response</span>
<span class="nx">  1</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="o">*</span> <span class="nx">url-availability</span><span class="p">]</span> <span class="c1">; url-availabilities</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 103</span>
<span class="nx">presentation-url-availability-event </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">1</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; watch-id</span>
  <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="o">*</span> <span class="nx">url-availability</span><span class="p">]</span> <span class="c1">; url-availabilities</span>
<span class="p">}</span></p>

<p><span class="c1">; idea: use HTTP response codes?</span>
<span class="nx">url-availability </span><span class="p">=</span> <span class="o">&amp;</span><span class="p">(</span>
  <span class="nx">available</span><span class="p">:</span> <span class="mi">0</span>
  <span class="nx">unavailable</span><span class="p">:</span> <span class="mi">1</span>
  <span class="nx">invalid</span><span class="p">:</span> <span class="mi">10</span>
<span class="p">)</span></p>

<p><span class="c1">; type key 104</span>
<span class="nx">presentation-start-request </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">request</span>
<span class="nx">  1</span><span class="p">:</span> <span class="nx">text </span><span class="c1">; presentation-id</span>
  <span class="mi">2</span><span class="p">:</span> <span class="nx">text </span><span class="c1">; url</span>
  <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">http-header</span><span class="p">]</span> <span class="c1">; headers</span>
<span class="p">}</span></p>

<p><span class="nx">http-header </span><span class="p">=</span> <span class="p">[</span>
  <span class="nx">key</span><span class="p">:</span> <span class="nx">text</span>
<span class="nx">  value</span><span class="p">:</span> <span class="nx">text</span>
<span class="p">]</span></p>

<p><span class="c1">; type key 105</span>
<span class="nx">presentation-start-response </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">response</span>
<span class="nx">  1</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">result </span><span class="c1">; result</span>
  <span class="mi">2</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; connection-id</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 106</span>
<span class="nx">presentation-termination-request </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">request</span>
<span class="nx">  1</span><span class="p">:</span> <span class="nx">text </span><span class="c1">; presentation-id</span>
  <span class="mi">2</span><span class="p">:</span> <span class="o">&amp;</span><span class="p">(</span>
    <span class="nx">controller-called-terminate</span><span class="p">:</span> <span class="mi">10</span>
    <span class="nx">user-terminated-via-controller</span><span class="p">:</span> <span class="mi">11</span>
    <span class="nx">unknown</span><span class="p">:</span> <span class="mi">255</span>
  <span class="p">)</span> <span class="c1">; reason</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 107</span>
<span class="nx">presentation-termination-response </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">response</span>
<span class="nx">  1</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">result </span><span class="c1">; result</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 108</span>
<span class="nx">presentation-termination-event </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">1</span><span class="p">:</span> <span class="nx">text </span><span class="c1">; presentation-id</span>
  <span class="mi">2</span><span class="p">:</span> <span class="o">&amp;</span><span class="p">(</span>
    <span class="nx">receiver-called-terminate</span><span class="p">:</span> <span class="mi">1</span>
    <span class="nx">user-terminated-via-receiver</span><span class="p">:</span> <span class="mi">2</span>
    <span class="nx">controller-called-terminate</span><span class="p">:</span> <span class="mi">10</span>
    <span class="nx">user-terminated-via-controller</span><span class="p">:</span> <span class="mi">11</span>
    <span class="nx">receiver-replaced-presentation</span><span class="p">:</span> <span class="mi">20</span>
    <span class="nx">receiver-idle-too-long</span><span class="p">:</span> <span class="mi">30</span>
    <span class="nx">receiver-attempted-to-navigate</span><span class="p">:</span> <span class="mi">31</span>
    <span class="nx">receiver-powering-down</span><span class="p">:</span> <span class="mi">100</span>
    <span class="nx">receiver-crashed</span><span class="p">:</span> <span class="mi">101</span>
    <span class="nx">unknown</span><span class="p">:</span> <span class="mi">255</span>
  <span class="p">)</span> <span class="c1">; reason</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 109</span>
<span class="nx">presentation-connection-open-request </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">request</span>
<span class="nx">  1</span><span class="p">:</span> <span class="nx">text </span><span class="c1">; presentation-id</span>
  <span class="mi">2</span><span class="p">:</span> <span class="nx">text </span><span class="c1">; url</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 110</span>
<span class="nx">presentation-connection-open-response </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">response</span>
<span class="nx">  1</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">result </span><span class="c1">; result</span>
  <span class="mi">2</span><span class="p">:</span> <span class="kt">uint</span><span class="c1">; connection-id</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 111</span>
<span class="nx">presentation-connection-close-request </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">request</span>
<span class="nx">  1</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; connection-id</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 112</span>
<span class="nx">presentation-connection-close-response </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">response</span>
<span class="nx">  1</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">result </span><span class="c1">; result</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 113</span>
<span class="nx">presentation-connection-close-event </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">1</span><span class="p">:</span> <span class="kt">uint</span><span class="c1">; connection-id</span>
  <span class="mi">2</span><span class="p">:</span> <span class="o">&amp;</span><span class="p">(</span>
    <span class="nx">close-method-called</span><span class="p">:</span> <span class="mi">1</span>
    <span class="nx">connection-object-discarded</span><span class="p">:</span> <span class="mi">10</span>
    <span class="nx">unrecoverable-error-while-sending-or-receiving-message</span><span class="p">:</span> <span class="mi">100</span>
  <span class="p">)</span> <span class="c1">; reason</span>
  <span class="p">?</span> <span class="mi">3</span><span class="p">:</span> <span class="nx">text </span><span class="c1">; error-message</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 16</span>
<span class="nx">presentation-connection-message </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">1</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; connection-id</span>
  <span class="mi">2</span><span class="p">:</span> <span class="nx">bytes </span><span class="o">/</span> <span class="nx">text </span><span class="c1">; message</span>
<span class="p">}</span></p>

<p><span class="nx">result </span><span class="p">=</span> <span class="p">(</span>
  <span class="nx">success</span><span class="p">:</span> <span class="mi">1</span>
  <span class="nx">invalid-url</span><span class="p">:</span> <span class="mi">10</span>
  <span class="nx">invalid-presentation-id</span><span class="p">:</span> <span class="mi">11</span>
  <span class="nx">timeout</span><span class="p">:</span> <span class="mi">100</span>
  <span class="nx">transient-error</span><span class="p">:</span> <span class="mi">101</span>
  <span class="nx">permanent-error</span><span class="p">:</span> <span class="mi">102</span>
  <span class="nx">terminating</span><span class="p">:</span> <span class="mi">103</span>
  <span class="nx">unknown-error</span><span class="p">:</span> <span class="mi">199</span>
<span class="p">)</span></p>

<p><span class="c1">; type key 17</span>
<span class="nx">remote-playback-availability-request </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">request</span>
<span class="nx">  1</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">text</span><span class="p">]</span> <span class="c1">; urls</span>
  <span class="mi">2</span><span class="p">:</span> <span class="nx">microseconds </span><span class="c1">; watch-duration</span>
  <span class="mi">3</span><span class="p">:</span> <span class="kt">int</span> <span class="c1">; watch-id</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 18</span>
<span class="nx">remote-playback-availability-response </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">response</span>
<span class="nx">  url-availabilities</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">url-availability</span><span class="p">]</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 114</span>
<span class="nx">remote-playback-availability-event </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">1</span><span class="p">:</span> <span class="kt">int</span> <span class="c1">; watch-id</span>
  <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">url-availability</span><span class="p">]</span> <span class="c1">; url-availabilities</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 115</span>
<span class="nx">remote-playback-start-request </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">request</span>
<span class="nx">  1</span><span class="p">:</span> <span class="nx">remote-playback-id </span><span class="c1">; remote-playback-id</span>
  <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">text</span><span class="p">]</span> <span class="c1">; urls</span>
  <span class="p">?</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">text</span><span class="p">]</span> <span class="c1">; text-track-urls</span>
  <span class="p">?</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">http-header</span><span class="p">]</span> <span class="c1">; headers</span>
  <span class="p">?</span> <span class="mi">5</span><span class="p">:</span> <span class="nx">remote-playback-controls </span><span class="c1">; controls</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 116</span>
<span class="nx">remote-playback-start-response </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">response</span>
<span class="nx">  1</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">result </span><span class="c1">; result</span>
  <span class="p">?</span> <span class="mi">2</span><span class="p">:</span> <span class="nx">remote-playback-state </span><span class="c1">; state</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 117</span>
<span class="nx">remote-playback-termination-request </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">request</span>
<span class="nx">  1</span><span class="p">:</span> <span class="nx">remote-playback-id </span><span class="c1">; remote-playback-id</span>
  <span class="mi">2</span><span class="p">:</span> <span class="o">&amp;</span><span class="p">(</span>
    <span class="nx">user-terminated-via-controller</span><span class="p">:</span> <span class="mi">11</span>
    <span class="nx">unknown</span><span class="p">:</span> <span class="mi">255</span>
  <span class="p">)</span> <span class="c1">; reason</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 118</span>
<span class="nx">remote-playback-termination-response </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">response</span>
<span class="nx">  1</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">result </span><span class="c1">; result</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 119</span>
<span class="nx">remote-playback-termination-event </span><span class="p">=</span> <span class="p">{</span>
 <span class="mi">1</span><span class="p">:</span> <span class="nx">remote-playback-id </span><span class="c1">; remote-playback-id</span>
 <span class="mi">2</span><span class="p">:</span> <span class="o">&amp;</span><span class="p">(</span>
    <span class="nx">receiver-called-terminate</span><span class="p">:</span> <span class="mi">1</span>
    <span class="nx">user-terminated-via-receiver</span><span class="p">:</span> <span class="mi">2</span>
    <span class="nx">receiver-idle-too-long</span><span class="p">:</span> <span class="mi">30</span>
    <span class="nx">receiver-powering-down</span><span class="p">:</span> <span class="mi">100</span>
    <span class="nx">receiver-crashed</span><span class="p">:</span> <span class="mi">101</span>
    <span class="nx">unknown</span><span class="p">:</span> <span class="mi">255</span>
  <span class="p">)</span> <span class="c1">; reason</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 19</span>
<span class="nx">remote-playback-modify-request </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">request</span>
<span class="nx">  1</span><span class="p">:</span> <span class="nx">remote-playback-id </span><span class="c1">; remote-playback-id</span>
  <span class="mi">2</span><span class="p">:</span> <span class="nx">remote-playback-controls </span><span class="c1">; controls</span>
<span class="p">)</span></p>

<p><span class="c1">; type key 20</span>
<span class="nx">remote-playback-modify-response </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">response</span>
<span class="nx">  1</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">result </span><span class="c1">; result</span>
  <span class="p">?</span> <span class="mi">2</span><span class="p">:</span> <span class="nx">remote-playback-state </span><span class="c1">; state</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 21</span>
<span class="nx">remote-playback-state-event </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">1</span><span class="p">:</span> <span class="nx">remote-playback-id </span><span class="c1">; remote-playback-id</span>
  <span class="mi">2</span><span class="p">:</span> <span class="nx">remote-playback-state </span><span class="c1">; state</span>
<span class="p">}</span></p>

<p><span class="nx">remote-playback-id </span><span class="p">=</span> <span class="kt">uint</span></p>

<p><span class="nx">remote-playback-controls </span><span class="p">=</span> <span class="p">{</span>
  <span class="p">?</span> <span class="mi">1</span><span class="p">:</span> <span class="nx">url </span><span class="c1">; source</span>
  <span class="p">?</span> <span class="mi">2</span><span class="p">:</span> <span class="o">&amp;</span><span class="p">(</span><span class="nx">none</span><span class="p">,</span> <span class="nx">metadata</span><span class="p">,</span> <span class="nx">auto</span><span class="p">)</span> <span class="c1">; preload</span>
  <span class="p">?</span> <span class="mi">3</span><span class="p">:</span> <span class="nx">bool </span><span class="c1">; loop</span>
  <span class="p">?</span> <span class="mi">4</span><span class="p">:</span> <span class="nx">bool </span><span class="c1">; paused</span>
  <span class="p">?</span> <span class="mi">5</span><span class="p">:</span> <span class="nx">bool </span><span class="c1">; muted</span>
  <span class="p">?</span> <span class="mi">6</span><span class="p">:</span> <span class="nx">float </span><span class="c1">; volume</span>
  <span class="p">?</span> <span class="mi">7</span><span class="p">:</span> <span class="nx">media-time </span><span class="c1">; seek</span>
  <span class="p">?</span> <span class="mi">8</span><span class="p">:</span> <span class="nx">media-time </span><span class="c1">; fast-seek</span>
  <span class="p">?</span> <span class="mi">9</span><span class="p">:</span> <span class="nx">float </span><span class="c1">; playback-rate</span>
  <span class="p">?</span> <span class="mi">10</span><span class="p">:</span> <span class="nx">url </span><span class="c1">; poster</span>
  <span class="p">?</span> <span class="mi">11</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">text</span><span class="p">]</span> <span class="c1">; enabled-audio-track-ids</span>
  <span class="p">?</span> <span class="mi">12</span><span class="p">:</span> <span class="nx">text </span><span class="c1">; selected-video-track-id</span>
  <span class="p">?</span> <span class="mi">13</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">added-text-track</span><span class="p">]</span> <span class="c1">; added-text-tracks</span>
  <span class="p">?</span> <span class="mi">14</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">changed-text-track</span><span class="p">]</span> <span class="c1">; changed-text-tracks</span>
<span class="p">}</span></p>

<p><span class="nx">remote-playback-state </span><span class="p">=</span> <span class="p">{</span>
  <span class="p">?</span> <span class="mi">1</span><span class="p">:</span> <span class="o">&amp;</span><span class="p">(</span><span class="nx">rate</span><span class="p">:</span> <span class="nx">bool</span><span class="p">,</span>
         <span class="nx">preload</span><span class="p">:</span> <span class="nx">bool</span><span class="p">,</span>
         <span class="nx">poster</span><span class="p">:</span> <span class="nx">bool</span><span class="p">,</span>
         <span class="nx">added-text-track</span><span class="p">:</span>
         <span class="nx">bool</span><span class="p">,</span>
         <span class="nx">added-cues</span><span class="p">:</span> <span class="nx">bool</span><span class="p">)</span> <span class="c1">; supports</span>
  <span class="p">?</span> <span class="mi">2</span><span class="p">:</span> <span class="nx">url </span><span class="c1">; source</span>
  <span class="p">?</span> <span class="mi">3</span><span class="p">:</span> <span class="o">&amp;</span><span class="p">(</span>
    <span class="nx">empty</span><span class="p">:</span> <span class="mi">0</span>
    <span class="nx">idle</span><span class="p">:</span> <span class="mi">1</span>
    <span class="nx">loading</span><span class="p">:</span> <span class="mi">2</span>
    <span class="nx">no-source</span><span class="p">:</span> <span class="mi">3</span>
  <span class="p">)</span> <span class="c1">; loading</span>
  <span class="p">?</span> <span class="mi">4</span><span class="p">:</span> <span class="o">&amp;</span><span class="p">(</span>
    <span class="nx">nothing</span><span class="p">:</span> <span class="mi">0</span>
    <span class="nx">metadata</span><span class="p">:</span> <span class="mi">1</span>
    <span class="nx">current</span><span class="p">:</span> <span class="mi">2</span>
    <span class="nx">future</span><span class="p">:</span> <span class="mi">3</span>
    <span class="nx">enough</span><span class="p">:</span> <span class="mi">4</span>
  <span class="p">)</span> <span class="c1">; loaded</span>
  <span class="p">?</span> <span class="mi">5</span><span class="p">:</span> <span class="nx">media-error </span><span class="p">:</span> <span class="nx">error</span>
<span class="nx">  </span><span class="p">?</span> <span class="mi">6</span><span class="p">:</span> <span class="nx">media-time </span><span class="o">/</span> <span class="nx">unknown</span><span class="c1">; epoch</span>
  <span class="p">?</span> <span class="mi">7</span><span class="p">:</span> <span class="nx">media-time </span><span class="o">/</span> <span class="nx">unknown </span><span class="o">/</span> <span class="nx">forever </span><span class="c1">; duration</span>
  <span class="p">?</span> <span class="mi">8</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">media-time-range</span><span class="p">]</span> <span class="c1">; buffered-time-ranges</span>
  <span class="p">?</span> <span class="mi">9</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">media-time-range</span><span class="p">]</span> <span class="c1">; seekable-time-ranges</span>
  <span class="p">?</span> <span class="mi">10</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">media-time-range</span><span class="p">]</span> <span class="c1">; played-time-ranges</span>
  <span class="p">?</span> <span class="mi">11</span><span class="p">:</span> <span class="nx">media-time </span><span class="c1">; position</span>
  <span class="p">?</span> <span class="mi">12</span><span class="p">:</span> <span class="nx">float </span><span class="p">:</span> <span class="nx">playbackRate</span>
<span class="nx">  </span><span class="p">?</span> <span class="mi">13</span><span class="p">:</span> <span class="nx">bool </span><span class="c1">; paused</span>
  <span class="p">?</span> <span class="mi">14</span><span class="p">:</span> <span class="nx">bool </span><span class="c1">; seeking</span>
  <span class="p">?</span> <span class="mi">15</span><span class="p">:</span> <span class="nx">bool </span><span class="c1">; stalled</span>
  <span class="p">?</span> <span class="mi">16</span><span class="p">:</span> <span class="nx">bool </span><span class="c1">; ended</span>
  <span class="p">?</span> <span class="mi">17</span><span class="p">:</span> <span class="nx">float </span><span class="c1">; volume</span>
  <span class="p">?</span> <span class="mi">18</span><span class="p">:</span> <span class="nx">bool </span><span class="c1">; muted</span>
  <span class="p">?</span> <span class="mi">19</span><span class="p">:</span> <span class="nx">video-resolution </span><span class="o">/</span> <span class="nx">unknown </span><span class="c1">; resolution</span>
  <span class="p">?</span> <span class="mi">20</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">audio-track-state</span><span class="p">]</span> <span class="nx">audio-tracks</span>
<span class="nx">  </span><span class="p">?</span> <span class="mi">21</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">video-track-state</span><span class="p">]</span> <span class="nx">video-tracks</span>
<span class="nx">  </span><span class="p">?</span> <span class="mi">22</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">text-track-state</span><span class="p">]</span> <span class="nx">text-tracks</span>
<span class="p">}</span></p>

<p><span class="nx">added-text-track </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">1</span><span class="p">:</span> <span class="o">&amp;</span><span class="p">(</span>
    <span class="nx">subtitles</span>
<span class="nx">    captions</span>
<span class="nx">    descriptions</span>
<span class="nx">    chapters</span>
<span class="nx">    metadata</span>
<span class="nx">  </span><span class="p">)</span> <span class="c1">; kind</span>
  <span class="p">?</span> <span class="mi">2</span><span class="p">:</span> <span class="nx">text </span><span class="c1">; label</span>
  <span class="p">?</span> <span class="mi">3</span><span class="p">:</span> <span class="nx">text </span><span class="c1">; language</span>
<span class="p">}</span></p>

<p><span class="nx">changed-text-track </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">1</span><span class="p">:</span> <span class="nx">text </span><span class="c1">; id</span>
  <span class="mi">2</span><span class="p">:</span> <span class="nx">mode </span><span class="c1">; mode</span>
  <span class="p">?</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">text-track-cue</span><span class="p">]</span> <span class="c1">; added-cues</span>
  <span class="p">?</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">text</span><span class="p">]</span> <span class="c1">; removed-cue-ids</span>
<span class="p">}</span></p>

<p><span class="nx">text-track-mode </span><span class="p">=</span> <span class="o">&amp;</span><span class="p">(</span>
  <span class="nx">disabled</span>
<span class="nx">  showing</span>
<span class="nx">  hidden</span>
<span class="p">)</span></p>

<p><span class="nx">text-track-cue </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">1</span><span class="p">:</span> <span class="nx">text </span><span class="c1">; id</span>
  <span class="mi">2</span><span class="p">:</span> <span class="nx">media-time-range </span><span class="c1">; range</span>
  <span class="mi">3</span><span class="p">:</span> <span class="nx">text </span><span class="c1">; text</span>
<span class="p">}</span></p>

<p><span class="nx">media-time-range </span><span class="p">=</span> <span class="p">[</span>
  <span class="nx">start</span><span class="p">:</span> <span class="nx">media-time</span><span class="p">,</span>
  <span class="nx">end</span><span class="p">:</span> <span class="nx">media-time</span>
<span class="p">]</span></p>

<p><span class="nx">media-time </span><span class="p">=</span> <span class="p">[</span>
  <span class="nx">value</span><span class="p">:</span> <span class="kt">uint</span>
  <span class="nx">scale</span><span class="p">:</span> <span class="kt">uint</span>
<span class="p">]</span></p>

<p><span class="nx">unknown </span><span class="p">=</span> <span class="mi">0</span>
<span class="nx">forever </span><span class="p">=</span> <span class="mi">1</span></p>

<p><span class="nx">media-error </span><span class="p">=</span> <span class="p">[</span>
  <span class="nx">code</span><span class="p">:</span> <span class="o">&amp;</span><span class="p">(</span>
    <span class="nx">user-aborted</span><span class="p">:</span> <span class="mi">1</span>
    <span class="nx">network-error</span><span class="p">:</span> <span class="mi">2</span>
    <span class="nx">decode-error</span><span class="p">:</span> <span class="mi">3</span>
    <span class="nx">source-not-supported</span><span class="p">:</span> <span class="mi">4</span>
    <span class="nx">unknown-error</span><span class="p">:</span> <span class="mi">5</span>
  <span class="p">)</span>
  <span class="nx">message</span><span class="p">:</span> <span class="nx">text</span>
<span class="p">]</span></p>

<p><span class="nx">track-state </span><span class="p">=</span> <span class="p">(</span>
  <span class="mi">1</span><span class="p">:</span> <span class="nx">text </span><span class="c1">; id</span>
  <span class="mi">2</span><span class="p">:</span> <span class="nx">text </span><span class="c1">; label</span>
  <span class="mi">3</span><span class="p">:</span> <span class="nx">text </span><span class="c1">; language</span>
<span class="p">)</span></p>

<p><span class="nx">audio-track-state </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">track-state</span>
<span class="nx">  4</span><span class="p">:</span> <span class="nx">bool </span><span class="c1">; enabled</span>
<span class="p">}</span></p>

<p><span class="nx">video-track-state </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">track-state</span>
<span class="nx">  5 </span><span class="p">:</span> <span class="nx">bool </span><span class="c1">; selected</span>
<span class="p">}</span></p>

<p><span class="nx">text-track-state </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">track-state</span>
<span class="nx">  6 </span><span class="p">:</span> <span class="nx">mode </span><span class="c1">; text-track-mode</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 22</span>
<span class="nx">audio-frame </span><span class="p">=</span> <span class="p">[</span>
  <span class="nx">encoding-id</span><span class="p">:</span> <span class="kt">uint</span>
  <span class="nx">start-time</span><span class="p">:</span> <span class="kt">uint</span>
  <span class="nx">payload</span><span class="p">:</span> <span class="nx">bytes</span>
<span class="nx">  </span><span class="p">?</span> <span class="nx">optional</span><span class="p">:</span> <span class="p">{</span>
    <span class="p">?</span> <span class="mi">0</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; duration</span>
    <span class="p">?</span> <span class="mi">1</span><span class="p">:</span> <span class="nx">media-time </span><span class="c1">; sync-time</span>
  <span class="p">}</span>
<span class="p">]</span></p>

<p><span class="c1">; type key 23</span>
<span class="nx">video-frame </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">0</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; encoding-id</span>
  <span class="mi">1</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; sequence-number</span>
  <span class="p">?</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="kt">int</span><span class="p">]</span> <span class="c1">; depends-on</span>
  <span class="mi">3</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; start-time</span>
  <span class="p">?</span> <span class="mi">4</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; duration</span>
  <span class="mi">5</span><span class="p">:</span> <span class="nx">bytes </span><span class="c1">; payload</span>
  <span class="p">?</span> <span class="mi">6</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; rotation</span>
  <span class="p">?</span> <span class="mi">7</span><span class="p">:</span> <span class="nx">media-time </span><span class="c1">; sync-time</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 24</span>
<span class="nx">data-frame </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">0</span><span class="p">:</span> <span class="kt">uint</span><span class="c1">; encoding-id</span>
  <span class="p">?</span> <span class="mi">1</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; sequence-number</span>
  <span class="p">?</span> <span class="mi">2</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; start-time</span>
  <span class="p">?</span> <span class="mi">3</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; duration</span>
  <span class="mi">4</span><span class="p">:</span> <span class="nx">any</span><span class="c1">; payload</span>
  <span class="p">?</span> <span class="mi">5</span><span class="p">:</span> <span class="nx">media-time </span><span class="c1">; sync-time</span>
<span class="p">}</span></p>

<p><span class="c1">; type key 120</span>
<span class="nx">video-frame-request </span><span class="p">=</span> <span class="p">{</span>
 <span class="mi">1</span><span class="p">:</span> <span class="kt">uint</span><span class="c1">; encoding-id</span>
 <span class="mi">2</span><span class="p">:</span> <span class="kt">uint</span><span class="c1">; sequence-number</span>
 <span class="p">?</span> <span class="mi">3</span><span class="p">:</span> <span class="kt">uint</span><span class="c1">; highest-decoded-frame-sequence-number</span>
<span class="p">}</span></p>

<p><span class="nx">ratio </span><span class="p">=</span> <span class="p">[</span>
  <span class="nx">antecedent</span><span class="p">:</span> <span class="kt">uint</span>
  <span class="nx">consequent</span><span class="p">:</span> <span class="kt">uint</span>
<span class="p">]</span></p>

<p><span class="nx">streaming-capabilities-request </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">request</span>
<span class="p">}</span></p>

<p><span class="nx">streaming-capabilities-response </span><span class="p">=</span> <span class="p">{</span>
  <span class="nx">response</span>
<span class="nx">  1</span><span class="p">:</span> <span class="nx">streaming-capabilities </span><span class="c1">; streaming-capabilities</span>
<span class="p">}</span></p>

<p><span class="nx">streaming-capabilities </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">receive-audio-capability</span><span class="p">]</span> <span class="c1">; receive-audio</span>
  <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">receive-video-capability</span><span class="p">]</span> <span class="c1">; receive-video</span>
  <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">receive-data-capability</span><span class="p">]</span> <span class="c1">; receive-data</span>
<span class="p">}</span></p>

<p><span class="nx">format </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">0</span><span class="p">:</span> <span class="nx">string </span><span class="c1">; name</span>
  <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">format-parameter</span><span class="p">]</span> <span class="c1">; parameters</span>
<span class="p">}</span></p>

<p><span class="nx">format-parameter </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">0</span><span class="p">:</span> <span class="nx">string </span><span class="c1">; key</span>
  <span class="mi">1</span><span class="p">:</span> <span class="nx">bytes </span><span class="c1">; value</span>
<span class="p">}</span></p>

<p><span class="nx">receive-audio-capability </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">0</span><span class="p">:</span> <span class="nx">format </span><span class="c1">; codec</span>
  <span class="p">?</span> <span class="mi">1</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; max-audio-channels</span>
  <span class="p">?</span> <span class="mi">2</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; min-bit-rate</span>
<span class="p">}</span></p>

<p><span class="nx">video-resolution </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">0</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; height</span>
  <span class="mi">1</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; width</span>
<span class="p">}</span></p>

<p><span class="nx">receive-video-capability </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">0</span><span class="p">:</span> <span class="nx">format </span><span class="c1">; codec</span>
  <span class="p">?</span> <span class="mi">1</span><span class="p">:</span> <span class="nx">video-resolution </span><span class="c1">; max-resolution</span>
  <span class="p">?</span> <span class="mi">2</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; max-frames-per-second</span>
  <span class="p">?</span> <span class="mi">3</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; max-pixels-per-second</span>
  <span class="p">?</span> <span class="mi">4</span><span class="p">:</span> <span class="kt">uint</span> <span class="c1">; min-bit-rate</span>
  <span class="p">?</span> <span class="mi">5</span><span class="p">:</span> <span class="nx">ratio </span><span class="c1">; aspect-ratio</span>
  <span class="p">?</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">string</span><span class="p">]</span> <span class="c1">; color-profiles</span>
  <span class="p">?</span> <span class="mi">7</span><span class="p">:</span> <span class="p">[</span><span class="o">*</span> <span class="nx">video-resolution</span><span class="p">]</span> <span class="c1">; native-resolutions</span>
  <span class="p">?</span> <span class="mi">8</span><span class="p">:</span> <span class="nx">bool </span><span class="c1">; supports-scaling</span>
<span class="p">}</span></p>

<p><span class="nx">receive-data-capability </span><span class="p">=</span> <span class="p">{</span>
  <span class="mi">0</span><span class="p">:</span> <span class="nx">format </span><span class="c1">; format</span>
<span class="p">}</span></p>
</pre>
   </div>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="conformance"><span class="content"> Conformance</span><a class="self-link" href="#conformance"></a></h2>
   <p> Conformance requirements are expressed with a combination of descriptive assertions and RFC 2119 terminology.
            The key words âMUSTâ, âMUST NOTâ, âREQUIREDâ, âSHALLâ, âSHALL NOTâ, âSHOULDâ, âSHOULD NOTâ, âRECOMMENDEDâ, âMAYâ, and âOPTIONALâ
            in the normative parts of this document
            are to be interpreted as described in RFC 2119.
            However, for readability,
            these words do not appear in all uppercase letters in this specification. </p>
   <p> All of the text of this specification is normative
            except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a> </p>
   <p> Examples in this specification are introduced with the words âfor exampleâ
            or are set apart from the normative text with <code>class="example"</code>, like this: </p>
   <div class="example" id="example-example"><a class="self-link" href="#example-example"></a> This is an example of an informative example. </div>
   <p> Informative notes begin with the word âNoteâ
            and are set apart from the normative text with <code>class="note"</code>, like this: </p>
   <p class="note" role="note"> Note, this is an informative note. </p>
  </div>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">â</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">â</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">â</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Donât scroll to compensate for the ToC if weâre above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I donât know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldnât exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isnât standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we donât have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While weâre at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Canât find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <aside class="dfn-panel" data-for="term-for-htmlmediaelement">
   <a href="https://html.spec.whatwg.org/multipage/media.html#htmlmediaelement">https://html.spec.whatwg.org/multipage/media.html#htmlmediaelement</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-htmlmediaelement">2.2. Remote Playback API Requirements</a> <a href="#ref-for-htmlmediaelementâ ">(2)</a> <a href="#ref-for-htmlmediaelementâ¡">(3)</a> <a href="#ref-for-htmlmediaelementâ¢">(4)</a>
    <li><a href="#termref-for-">7.4. Remote Playback State and Controls</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-window-postmessage">
   <a href="https://html.spec.whatwg.org/multipage/web-messaging.html#dom-window-postmessage">https://html.spec.whatwg.org/multipage/web-messaging.html#dom-window-postmessage</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-window-postmessage">10.1.4. Same-Origin Policy Violations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-presentationconnection">
   <a href="https://w3c.github.io/presentation-api/#presentationconnection">https://w3c.github.io/presentation-api/#presentationconnection</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-presentationconnection">2.1. Presentation API Requirements</a> <a href="#ref-for-presentationconnectionâ ">(2)</a>
    <li><a href="#ref-for-presentationconnectionâ¡">10.1.4. Same-Origin Policy Violations</a>
    <li><a href="#ref-for-presentationconnectionâ¢">10.3. Presentation API Considerations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-available-presentation-display">
   <a href="https://w3c.github.io/presentation-api/#dfn-available-presentation-display">https://w3c.github.io/presentation-api/#dfn-available-presentation-display</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-available-presentation-display">7.1. Presentation Protocol</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-controller">
   <a href="https://w3c.github.io/presentation-api/#dfn-controller">https://w3c.github.io/presentation-api/#dfn-controller</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-controller">1.1. Terminology</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-controlling-user-agent">
   <a href="https://w3c.github.io/presentation-api/#dfn-controlling-user-agent">https://w3c.github.io/presentation-api/#dfn-controlling-user-agent</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-controlling-user-agent">1.1. Terminology</a>
    <li><a href="#ref-for-dfn-controlling-user-agentâ ">2.1. Presentation API Requirements</a>
    <li><a href="#ref-for-dfn-controlling-user-agentâ¡">2.2. Remote Playback API Requirements</a>
    <li><a href="#ref-for-dfn-controlling-user-agentâ¢">7.2. Presentation API</a> <a href="#ref-for-dfn-controlling-user-agentâ£">(2)</a> <a href="#ref-for-dfn-controlling-user-agentâ¤">(3)</a> <a href="#ref-for-dfn-controlling-user-agentâ¥">(4)</a> <a href="#ref-for-dfn-controlling-user-agentâ¦">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-presentation-display">
   <a href="https://w3c.github.io/presentation-api/#dfn-presentation-display">https://w3c.github.io/presentation-api/#dfn-presentation-display</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-presentation-display">1.1. Terminology</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-presentation-display-availability">
   <a href="https://w3c.github.io/presentation-api/#dfn-presentation-display-availability">https://w3c.github.io/presentation-api/#dfn-presentation-display-availability</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-presentation-display-availability">1.1. Terminology</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-presentation-id">
   <a href="https://w3c.github.io/presentation-api/#dfn-presentation-id">https://w3c.github.io/presentation-api/#dfn-presentation-id</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-presentation-id">2.1. Presentation API Requirements</a> <a href="#ref-for-dfn-presentation-idâ ">(2)</a> <a href="#ref-for-dfn-presentation-idâ¡">(3)</a>
    <li><a href="#ref-for-dfn-presentation-idâ¢">10.1.4. Same-Origin Policy Violations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-presentation-request-url">
   <a href="https://w3c.github.io/presentation-api/#dfn-presentation-request-url">https://w3c.github.io/presentation-api/#dfn-presentation-request-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-presentation-request-url">1.1. Terminology</a>
    <li><a href="#ref-for-dfn-presentation-request-urlâ ">2.1. Presentation API Requirements</a> <a href="#ref-for-dfn-presentation-request-urlâ¡">(2)</a> <a href="#ref-for-dfn-presentation-request-urlâ¢">(3)</a> <a href="#ref-for-dfn-presentation-request-urlâ£">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-receiver">
   <a href="https://w3c.github.io/presentation-api/#dfn-receiver">https://w3c.github.io/presentation-api/#dfn-receiver</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-receiver">1.1. Terminology</a> <a href="#ref-for-dfn-receiverâ ">(2)</a>
    <li><a href="#ref-for-dfn-receiverâ¡">7.1. Presentation Protocol</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-receiving-user-agent">
   <a href="https://w3c.github.io/presentation-api/#dfn-receiving-user-agent">https://w3c.github.io/presentation-api/#dfn-receiving-user-agent</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-receiving-user-agent">1.1. Terminology</a>
    <li><a href="#ref-for-dfn-receiving-user-agentâ ">7.2. Presentation API</a> <a href="#ref-for-dfn-receiving-user-agentâ¡">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-availability-sources-set">
   <a href="https://w3c.github.io/remote-playback/#dfn-availability-sources-set">https://w3c.github.io/remote-playback/#dfn-availability-sources-set</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-availability-sources-set">7.5. Remote Playback API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-compatible-remote-playback-device">
   <a href="https://w3c.github.io/remote-playback/#dfn-compatible-remote-playback-device">https://w3c.github.io/remote-playback/#dfn-compatible-remote-playback-device</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-compatible-remote-playback-device">7.3. Remote Playback Protocol</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-initiate-remote-playback">
   <a href="https://w3c.github.io/remote-playback/#dfn-initiate-remote-playback">https://w3c.github.io/remote-playback/#dfn-initiate-remote-playback</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-initiate-remote-playback">2.2. Remote Playback API Requirements</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-media-element-state">
   <a href="https://w3c.github.io/remote-playback/#dfn-media-element-state">https://w3c.github.io/remote-playback/#dfn-media-element-state</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-media-element-state">2.2. Remote Playback API Requirements</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-media-resources">
   <a href="https://w3c.github.io/remote-playback/#dfn-media-resources">https://w3c.github.io/remote-playback/#dfn-media-resources</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-media-resources">7.3. Remote Playback Protocol</a> <a href="#ref-for-dfn-media-resourcesâ ">(2)</a> <a href="#ref-for-dfn-media-resourcesâ¡">(3)</a> <a href="#ref-for-dfn-media-resourcesâ¢">(4)</a>
    <li><a href="#ref-for-dfn-media-resourcesâ£">7.4. Remote Playback State and Controls</a> <a href="#ref-for-dfn-media-resourcesâ¤">(2)</a> <a href="#ref-for-dfn-media-resourcesâ¥">(3)</a> <a href="#ref-for-dfn-media-resourcesâ¦">(4)</a> <a href="#ref-for-dfn-media-resourcesâ§">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-remote-playback-devices">
   <a href="https://w3c.github.io/remote-playback/#dfn-remote-playback-devices">https://w3c.github.io/remote-playback/#dfn-remote-playback-devices</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-remote-playback-devices">1.1. Terminology</a>
    <li><a href="#ref-for-dfn-remote-playback-devicesâ ">2.2. Remote Playback API Requirements</a>
    <li><a href="#ref-for-dfn-remote-playback-devicesâ¡">7.3. Remote Playback Protocol</a>
    <li><a href="#ref-for-dfn-remote-playback-devicesâ¢">7.5. Remote Playback API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-remote-playback-source">
   <a href="https://w3c.github.io/remote-playback/#dfn-remote-playback-source">https://w3c.github.io/remote-playback/#dfn-remote-playback-source</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-remote-playback-source">7.5. Remote Playback API</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-htmlmediaelement" style="color:initial">HTMLMediaElement</span>
     <li><span class="dfn-paneled" id="term-for-dom-window-postmessage" style="color:initial">postMessage(message, targetOrigin, transfer)</span>
    </ul>
   <li>
    <a data-link-type="biblio">[PRESENTATION-API]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-presentationconnection" style="color:initial">PresentationConnection</span>
     <li><span class="dfn-paneled" id="term-for-dfn-available-presentation-display" style="color:initial">available presentation display</span>
     <li><span class="dfn-paneled" id="term-for-dfn-controller" style="color:initial">controller</span>
     <li><span class="dfn-paneled" id="term-for-dfn-controlling-user-agent" style="color:initial">controlling user agent</span>
     <li><span class="dfn-paneled" id="term-for-dfn-presentation-display" style="color:initial">presentation display</span>
     <li><span class="dfn-paneled" id="term-for-dfn-presentation-display-availability" style="color:initial">presentation display availability</span>
     <li><span class="dfn-paneled" id="term-for-dfn-presentation-id" style="color:initial">presentation id</span>
     <li><span class="dfn-paneled" id="term-for-dfn-presentation-request-url" style="color:initial">presentation request url</span>
     <li><span class="dfn-paneled" id="term-for-dfn-receiver" style="color:initial">receiver</span>
     <li><span class="dfn-paneled" id="term-for-dfn-receiving-user-agent" style="color:initial">receiving user agent</span>
    </ul>
   <li>
    <a data-link-type="biblio">[REMOTE-PLAYBACK]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-dfn-availability-sources-set" style="color:initial">availability sources set</span>
     <li><span class="dfn-paneled" id="term-for-dfn-compatible-remote-playback-device" style="color:initial">compatible remote playback device</span>
     <li><span class="dfn-paneled" id="term-for-dfn-initiate-remote-playback" style="color:initial">initiate remote playback</span>
     <li><span class="dfn-paneled" id="term-for-dfn-media-element-state" style="color:initial">media element state</span>
     <li><span class="dfn-paneled" id="term-for-dfn-media-resources" style="color:initial">media resources</span>
     <li><span class="dfn-paneled" id="term-for-dfn-remote-playback-devices" style="color:initial">remote playback devices</span>
     <li><span class="dfn-paneled" id="term-for-dfn-remote-playback-source" style="color:initial">remote playback source</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-presentation-api">[PRESENTATION-API]
   <dd>Mark Foltz; Dominik RÃ¶ttsches. <a href="https://www.w3.org/TR/presentation-api/">Presentation API</a>. 1 June 2017. CR. URL: <a href="https://www.w3.org/TR/presentation-api/">https://www.w3.org/TR/presentation-api/</a>
   <dt id="biblio-remote-playback">[REMOTE-PLAYBACK]
   <dd>Mounir Lamouri; Anton Vayvod. <a href="https://www.w3.org/TR/remote-playback/">Remote Playback API</a>. 19 October 2017. CR. URL: <a href="https://www.w3.org/TR/remote-playback/">https://www.w3.org/TR/remote-playback/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-cddl">[CDDL]
   <dd>H. Birkholz; C. Vigano; C. Bormann. <a href="https://datatracker.ietf.org/doc/draft-ietf-cbor-cddl/">Concise data definition language (CDDL): a notational convention to express CBOR and JSON data structures</a>. Internet Draft. URL: <a href="https://datatracker.ietf.org/doc/draft-ietf-cbor-cddl/">https://datatracker.ietf.org/doc/draft-ietf-cbor-cddl/</a>
   <dt id="biblio-quic">[QUIC]
   <dd>J. Iyengar; M. Thomson. <a href="https://tools.ietf.org/html/draft-ietf-quic-transport-16">Concise data definition language (CDDL): a notational convention to express CBOR and JSON data structures</a>. 23 October 2018. Internet Draft. URL: <a href="https://tools.ietf.org/html/draft-ietf-quic-transport-16">https://tools.ietf.org/html/draft-ietf-quic-transport-16</a>
   <dt id="biblio-rfc6762">[RFC6762]
   <dd>S. Cheshire; M. Krochmal. <a href="https://tools.ietf.org/html/rfc6762">Multicast DNS</a>. February 2013. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6762">https://tools.ietf.org/html/rfc6762</a>
   <dt id="biblio-rfc6763">[RFC6763]
   <dd>S. Cheshire; M. Krochmal. <a href="https://tools.ietf.org/html/rfc6763">DNS-Based Service Discovery</a>. February 2013. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6763">https://tools.ietf.org/html/rfc6763</a>
   <dt id="biblio-rfc7049">[RFC7049]
   <dd>C. Bormann; P. Hoffman. <a href="https://tools.ietf.org/html/rfc7049">Concise Binary Object Representation (CBOR)</a>. October 2013. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7049">https://tools.ietf.org/html/rfc7049</a>
   <dt id="biblio-security-privacy-questionnaire">[SECURITY-PRIVACY-QUESTIONNAIRE]
   <dd>Lukasz Olejnik; Jason Novak. <a href="https://www.w3.org/TR/security-privacy-questionnaire/">Self-Review Questionnaire: Security and Privacy</a>. 23 May 2019. NOTE. URL: <a href="https://www.w3.org/TR/security-privacy-questionnaire/">https://www.w3.org/TR/security-privacy-questionnaire/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> Add short names to Presentation API spec, so that BS autolinking works as designed.<a href="#issue-b711fac3"> âµ </a></div>
   <div class="issue"> Can autolinks to HTML51 be automatically generated?<a href="#issue-a8c8d59b"> âµ </a></div>
   <div class="issue"> Receiver/Controller/Agent terminology. <a href="https://github.com/webscreens/openscreenprotocol/issues/144">&lt;https://github.com/webscreens/openscreenprotocol/issues/144></a><a href="#issue-8ce75287"> âµ </a></div>
   <div class="issue"> Define suspend and resume behavior for discovery protocol. <a href="https://github.com/webscreens/openscreenprotocol/issues/107">&lt;https://github.com/webscreens/openscreenprotocol/issues/107></a><a href="#issue-56c2cd35"> âµ </a></div>
   <div class="issue"> Include cross references to the specs for these hash functions.<a href="#issue-ad92979f"> âµ </a></div>
   <div class="issue"> Add examples of sample mDNS records.<a href="#issue-49bdd4e6"> âµ </a></div>
   <div class="issue"> Define suspend and resume behavior for connection protocol. <a href="https://github.com/webscreens/openscreenprotocol/issues/108">&lt;https://github.com/webscreens/openscreenprotocol/issues/108></a><a href="#issue-e0955a17"> âµ </a></div>
   <div class="issue"> Clarify scoping/uniqueness of request IDs. <a href="https://github.com/webscreens/openscreenprotocol/issues/139">&lt;https://github.com/webscreens/openscreenprotocol/issues/139></a><a href="#issue-7a02cf11"> âµ </a></div>
   <div class="issue"> Add a capability that indicates support for the presentation protocol. <a href="https://github.com/webscreens/openscreenprotocol/issues/123">&lt;https://github.com/webscreens/openscreenprotocol/issues/123></a><a href="#issue-4f0d9dbd"> âµ </a></div>
   <div class="issue"> Refinements to Presentation API protocol. <a href="https://github.com/webscreens/openscreenprotocol/issues/160">&lt;https://github.com/webscreens/openscreenprotocol/issues/160></a><a href="#issue-905f29c0"> âµ </a></div>
   <div class="issue"> Is a Presentation close/terminate from a controller a request/response or event? <a href="https://github.com/webscreens/openscreenprotocol/issues/124">&lt;https://github.com/webscreens/openscreenprotocol/issues/124></a><a href="#issue-b4b59633"> âµ </a></div>
   <div class="issue"> Remove presentation-connection-close-response message. <a href="https://github.com/webscreens/openscreenprotocol/issues/138">&lt;https://github.com/webscreens/openscreenprotocol/issues/138></a><a href="#issue-1a6da4e3"> âµ </a></div>
   <div class="issue"> Once the Presentation API has text about reconnecting via an
implementation specific mechanism, quote that here and map it to a message.<a href="#issue-733afe74"> âµ </a></div>
   <div class="issue"> Add a capability that indicates support for the remote playback protocol. <a href="https://github.com/webscreens/openscreenprotocol/issues/123">&lt;https://github.com/webscreens/openscreenprotocol/issues/123></a><a href="#issue-74ff7a9d"> âµ </a></div>
   <div class="issue"> Make a required/default remote playback state table. <a href="https://github.com/webscreens/openscreenprotocol/issues/148">&lt;https://github.com/webscreens/openscreenprotocol/issues/148></a><a href="#issue-58529898"> âµ </a></div>
   <div class="issue"> Refinements to Remote Playback protocol. <a href="https://github.com/webscreens/openscreenprotocol/issues/159">&lt;https://github.com/webscreens/openscreenprotocol/issues/159></a><a href="#issue-649c173f"> âµ </a></div>
   <div class="issue"> Remote Playback HTTP headers. <a href="https://github.com/webscreens/openscreenprotocol/issues/146">&lt;https://github.com/webscreens/openscreenprotocol/issues/146></a><a href="#issue-9145071e"> âµ </a></div>
   <div class="issue"> Remote playback ID uniqueness. <a href="https://github.com/webscreens/openscreenprotocol/issues/147">&lt;https://github.com/webscreens/openscreenprotocol/issues/147></a><a href="#issue-edcdffff"> âµ </a></div>
   <div class="issue"> Add a table for whether itâs required and what the default is.<a href="#issue-6098c204"> âµ </a></div>
   <div class="issue"> Algorithm for what messages to send when local/remote media element changes. <a href="https://github.com/webscreens/openscreenprotocol/issues/158">&lt;https://github.com/webscreens/openscreenprotocol/issues/158></a><a href="#issue-156f1d74"> âµ </a></div>
   <div class="issue"> Fate of metadata / authentication history when clearing browsing data. <a href="https://github.com/webscreens/openscreenprotocol/issues/132">&lt;https://github.com/webscreens/openscreenprotocol/issues/132></a><a href="#issue-8bf4aa9f"> âµ </a></div>
   <div class="issue"> Notify endpoints when new connection is created. <a href="https://github.com/webscreens/openscreenprotocol/issues/143">&lt;https://github.com/webscreens/openscreenprotocol/issues/143></a><a href="#issue-edc1d8c1"> âµ </a></div>
   <div class="issue"> Review attack and mitigation considerations for TLS 1.3 <a href="https://github.com/webscreens/openscreenprotocol/issues/130">&lt;https://github.com/webscreens/openscreenprotocol/issues/130></a><a href="#issue-84520e29"> âµ </a></div>
   <div class="issue"> UI guidelines for pairing and trusted/untrusted data. <a href="https://github.com/webscreens/openscreenprotocol/issues/118">&lt;https://github.com/webscreens/openscreenprotocol/issues/118></a><a href="#issue-d435d3a9"> âµ </a></div>
   <div class="issue"> Review attack and mitigation considerations for TLS 1.3 <a href="https://github.com/webscreens/openscreenprotocol/issues/130">&lt;https://github.com/webscreens/openscreenprotocol/issues/130></a><a href="#issue-84520e29â "> âµ </a></div>
   <div class="issue"> Mitigations for remote network attackers. <a href="https://github.com/webscreens/openscreenprotocol/issues/131">&lt;https://github.com/webscreens/openscreenprotocol/issues/131></a><a href="#issue-7e863472"> âµ </a></div>
  </div>
<script>/* script-dfn-panel */

document.body.addEventListener("click", function(e) {
    var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
    // Find the dfn element or panel, if any, that was clicked on.
    var el = e.target;
    var target;
    var hitALink = false;
    while(el.parentElement) {
        if(el.tagName == "A") {
            // Clicking on a link in a <dfn> shouldn't summon the panel
            hitALink = true;
        }
        if(el.classList.contains("dfn-paneled")) {
            target = "dfn";
            break;
        }
        if(el.classList.contains("dfn-panel")) {
            target = "dfn-panel";
            break;
        }
        el = el.parentElement;
    }
    if(target != "dfn-panel") {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
            el.classList.remove("on");
            el.classList.remove("activated");
        });
    }
    if(target == "dfn" && !hitALink) {
        // open the panel
        var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
        if(dfnPanel) {
            dfnPanel.classList.add("on");
            var rect = el.getBoundingClientRect();
            dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
            dfnPanel.style.top = window.scrollY + rect.top + "px";
            var panelRect = dfnPanel.getBoundingClientRect();
            var panelWidth = panelRect.right - panelRect.left;
            if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                // Reposition, because the panel is overflowing
                dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
            }
        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
        }
    } else if(target == "dfn-panel") {
        // Switch it to "activated" state, which pins it.
        el.classList.add("activated");
        el.style.left = null;
        el.style.top = null;
    }

});
</script>